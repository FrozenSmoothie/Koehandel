{"timers": {"training_iteration": 0.48901280004065484, "restore_env_runners": 1.6899954061955214e-05, "training_step": 0.48873529996490106, "env_runner_sampling_timer": 0.15791489998809993, "learner_update_timer": 0.32196259999182075, "synch_weights": 0.007943499949760735}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.915462986566069e-05, "agent_to_module_mapping": 5.03414168759802e-06, "batch_individual_items": 2.0797626008751568e-05, "add_time_dim_to_batch_and_zero_pad": 7.90940010261082e-06, "add_observations_from_episodes_to_batch": 2.607473726746845e-05, "add_states_from_episodes_to_batch": 3.3286478269310534e-06}}, "connector_pipeline_timer": 0.00016158311145932896}, "num_agent_steps_sampled_lifetime": {"player_0": 96.0, "player_2": 96.0, "player_3": 96.0, "player_1": 96.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 0.0001414338629959943, "remove_single_ts_time_rank_from_batch": 1.6463748443873687e-06, "listify_data_for_vector_env": 8.929816859003538e-06, "get_actions": 0.00047764195692860266, "un_batch_to_individual_items": 2.3876489010377293e-05, "normalize_and_clip_actions": 0.000131478299145671, "module_to_agent_unmapping": 4.8003161588333245e-06}}, "connector_pipeline_timer": 0.0008922691925670311}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 21.51057128444415, "num_module_steps_sampled_lifetime": {"player_0": 384.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.0725949734977621, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 5.4742204293835116e-05, "env_to_module_sum_episodes_length_out": 21.51057128444415, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.016977449995465577, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 384.0, "rlmodule_inference_timer": 0.0007110891590279499, "num_env_steps_sampled_lifetime_throughput": NaN}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005418299988377839, "add_time_dim_to_batch_and_zero_pad": 1.5900004655122757e-05, "add_columns_from_episodes_to_train_batch": 0.0032687000348232687, "agent_to_module_mapping": 0.00017820001812651753, "add_observations_from_episodes_to_batch": 0.000222100003156811, "add_states_from_episodes_to_batch": 6.599992047995329e-06, "add_one_ts_to_episodes_and_truncate": 0.0020491000032052398, "numpy_to_tensor": 0.00023200002033263445, "batch_individual_items": 0.004034699988551438}}, "connector_pipeline_timer": 0.015818100015167147}, "num_module_steps_trained_lifetime": 1344, "num_env_steps_trained": 5376, "learner_connector_sum_episodes_length_out": 256, "num_module_steps_trained": 1344, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 5376, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "player_0": {"policy_loss": -0.18670746684074402, "vf_loss_unclipped": 0.0006011323421262205, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.10000000149011612, "vf_explained_var": -1.0, "total_loss": -0.2616935074329376, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1344, "entropy": 7.565064430236816, "vf_loss": 0.0006011323421262205, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0018201664788648486, "num_module_steps_trained_lifetime": 1344, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 384.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "e5023_00000", "date": "2025-10-21_13-05-58", "timestamp": 1761044758, "time_this_iter_s": 0.49315524101257324, "time_total_s": 0.49315524101257324, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100056F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 0.49315524101257324, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 85.7, "ram_util_percent": 54.4}}
{"timers": {"training_iteration": 0.49175496204057706, "restore_env_runners": 1.6893954598344862e-05, "training_step": 0.49147624996548983, "env_runner_sampling_timer": 0.16086471098824404, "learner_update_timer": 0.3217742639919743, "synch_weights": 0.007925291950232349, "synch_env_connectors": 0.00257060001604259}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2415783416381904e-05, "agent_to_module_mapping": 4.481077997441471e-06, "batch_individual_items": 1.7337198386295964e-05, "add_time_dim_to_batch_and_zero_pad": 6.691992013480503e-06, "add_observations_from_episodes_to_batch": 2.2293015994445326e-05, "add_states_from_episodes_to_batch": 3.0755881679859724e-06}}, "connector_pipeline_timer": 0.00013458558678179346}, "num_agent_steps_sampled_lifetime": {"player_0": 160.0, "player_2": 160.0, "player_3": 160.0, "player_1": 160.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 7.562313003187647e-05, "remove_single_ts_time_rank_from_batch": 2.0190484543344047e-06, "listify_data_for_vector_env": 6.95048232322352e-06, "get_actions": 0.0002662886227346493, "un_batch_to_individual_items": 1.863446077341285e-05, "normalize_and_clip_actions": 5.49973911680233e-05, "module_to_agent_unmapping": 3.809866885002454e-06}}, "connector_pipeline_timer": 0.0004998590141525274}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 31.929421494348023, "num_module_steps_sampled_lifetime": {"player_0": 640.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07232007543487913, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.269354894658567e-05, "env_to_module_sum_episodes_length_out": 31.929421494348023, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.02061113257561519, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 640.0, "rlmodule_inference_timer": 0.00032180513220156267, "num_env_steps_sampled_lifetime_throughput": 311.58221692902987}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005376927988254465, "add_time_dim_to_batch_and_zero_pad": 1.5899004647508264e-05, "add_columns_from_episodes_to_train_batch": 0.0032670090347528455, "agent_to_module_mapping": 0.00017809401790145786, "add_observations_from_episodes_to_batch": 0.0002211180032463744, "add_states_from_episodes_to_batch": 6.572991842404008e-06, "add_one_ts_to_episodes_and_truncate": 0.002039879003423266, "numpy_to_tensor": 0.00023114302020985634, "batch_individual_items": 0.004027995988726616}}, "connector_pipeline_timer": 0.0157545790146105}, "num_module_steps_trained_lifetime": 2752, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 11008, "num_env_steps_trained_lifetime_throughput": NaN, "num_module_steps_trained_throughput": NaN, "num_module_steps_trained_lifetime_throughput": NaN}, "player_0": {"policy_loss": -0.00738934800028801, "vf_loss_unclipped": 0.0007221132982522249, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.03125, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.05000000074505806, "vf_explained_var": -1.0, "total_loss": -0.0825430229306221, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.565266132354736, "vf_loss": 0.0007221132982522249, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0013791541568934917, "num_module_steps_trained_lifetime": 2752, "num_module_steps_trained_lifetime_throughput": NaN}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 640.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "e5023_00000", "date": "2025-10-21_13-05-59", "timestamp": 1761044759, "time_this_iter_s": 0.7693099975585938, "time_total_s": 1.262465238571167, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000ABF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.262465238571167, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.8, "ram_util_percent": 54.5}}
{"timers": {"training_iteration": 0.49197519741985013, "restore_env_runners": 1.6814015147974714e-05, "training_step": 0.4916961374655075, "env_runner_sampling_timer": 0.16128482887806603, "learner_update_timer": 0.32161754935213827, "synch_weights": 0.007886671030457364, "synch_env_connectors": 0.002573728015413508}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.957151225441149e-05, "agent_to_module_mapping": 5.120147972947993e-06, "batch_individual_items": 2.075028044400675e-05, "add_time_dim_to_batch_and_zero_pad": 7.89303874781216e-06, "add_observations_from_episodes_to_batch": 2.5064179976020285e-05, "add_states_from_episodes_to_batch": 3.567397770901899e-06}}, "connector_pipeline_timer": 0.00015736251861718362}, "num_agent_steps_sampled_lifetime": {"player_0": 224.0, "player_2": 224.0, "player_3": 224.0, "player_1": 224.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.60206059883765e-05, "remove_single_ts_time_rank_from_batch": 1.7328302245957324e-06, "listify_data_for_vector_env": 7.071042940338157e-06, "get_actions": 0.0002535078782360146, "un_batch_to_individual_items": 2.025381542708511e-05, "normalize_and_clip_actions": 3.765561928612287e-05, "module_to_agent_unmapping": 4.027329074285605e-06}}, "connector_pipeline_timer": 0.0004623671047340166}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 34.80764624034223, "num_module_steps_sampled_lifetime": {"player_0": 896.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07238859682862564, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.7804373226148654e-05, "env_to_module_sum_episodes_length_out": 34.80764624034223, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.026802911547130513, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 896.0, "rlmodule_inference_timer": 0.0002840877486847822, "num_env_steps_sampled_lifetime_throughput": 320.0046871868978}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005336713708558818, "add_time_dim_to_batch_and_zero_pad": 1.5904014685656874e-05, "add_columns_from_episodes_to_train_batch": 0.0032700579445576294, "agent_to_module_mapping": 0.00017824207785888577, "add_observations_from_episodes_to_batch": 0.00022023082340019752, "add_states_from_episodes_to_batch": 6.608262110967189e-06, "add_one_ts_to_episodes_and_truncate": 0.002032268213556381, "numpy_to_tensor": 0.00023064058981253765, "batch_individual_items": 0.0040278050285065545}}, "connector_pipeline_timer": 0.015706177224335264}, "num_module_steps_trained_lifetime": 4160, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 16640, "num_env_steps_trained_lifetime_throughput": 10502.076453314889, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2625.472113979339}, "player_0": {"policy_loss": -0.03181318938732147, "vf_loss_unclipped": 0.0007095961482264102, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0166666507720947, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.02500000037252903, "vf_explained_var": -1.0, "total_loss": -0.1070035919547081, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.5620856285095215, "vf_loss": 0.0007095961482264102, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0015132634434849024, "num_module_steps_trained_lifetime": 4160, "num_module_steps_trained_lifetime_throughput": 2625.5249886863094}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 896.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "e5023_00000", "date": "2025-10-21_13-05-59", "timestamp": 1761044759, "time_this_iter_s": 0.5169053077697754, "time_total_s": 1.7793705463409424, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.7793705463409424, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.5, "ram_util_percent": 54.5}}
{"timers": {"training_iteration": 0.492594446445649, "restore_env_runners": 1.673987454810413e-05, "training_step": 0.49231479709130627, "env_runner_sampling_timer": 0.16210827158904342, "learner_update_timer": 0.3214244498584254, "synch_weights": 0.007876026320416422, "synch_env_connectors": 0.0025689917351002806}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.629914174126681e-05, "agent_to_module_mapping": 4.849911074390742e-06, "batch_individual_items": 1.9395755729092366e-05, "add_time_dim_to_batch_and_zero_pad": 7.732938805082332e-06, "add_observations_from_episodes_to_batch": 2.3528973008393924e-05, "add_states_from_episodes_to_batch": 3.4160984300545026e-06}}, "connector_pipeline_timer": 0.00014712417913565346}, "num_agent_steps_sampled_lifetime": {"player_0": 288.0, "player_2": 288.0, "player_3": 288.0, "player_1": 288.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.837414885623975e-05, "remove_single_ts_time_rank_from_batch": 1.5490823391217365e-06, "listify_data_for_vector_env": 6.795063989723703e-06, "get_actions": 0.00022487483561065843, "un_batch_to_individual_items": 1.899685523037032e-05, "normalize_and_clip_actions": 3.0297175868549163e-05, "module_to_agent_unmapping": 3.845631307699572e-06}}, "connector_pipeline_timer": 0.000412687074138922}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.60276062643626, "num_module_steps_sampled_lifetime": {"player_0": 1152.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07227403248924189, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.482295915682398e-05, "env_to_module_sum_episodes_length_out": 35.60276062643626, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.0299175724421708, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 1152.0, "rlmodule_inference_timer": 0.00022870247321551376, "num_env_steps_sampled_lifetime_throughput": 326.4408570158287}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005298007571350609, "add_time_dim_to_batch_and_zero_pad": 1.58349746420281e-05, "add_columns_from_episodes_to_train_batch": 0.0032672193649041, "agent_to_module_mapping": 0.00017793065722176106, "add_observations_from_episodes_to_batch": 0.0002191355154463672, "add_states_from_episodes_to_batch": 6.575179741135798e-06, "add_one_ts_to_episodes_and_truncate": 0.0020276385310072803, "numpy_to_tensor": 0.00023470618412160547, "batch_individual_items": 0.00401932497820328}}, "connector_pipeline_timer": 0.015651674451879927}, "num_module_steps_trained_lifetime": 5568, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 22272, "num_env_steps_trained_lifetime_throughput": 10473.845560199821, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2618.413299659591}, "player_0": {"policy_loss": -0.22481520473957062, "vf_loss_unclipped": 0.0006258069770410657, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0689655542373657, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.012500000186264515, "vf_explained_var": -1.0, "total_loss": -0.30004385113716125, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.558849334716797, "vf_loss": 0.0006258069770410657, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0018772289622575045, "num_module_steps_trained_lifetime": 5568, "num_module_steps_trained_lifetime_throughput": 2618.4671908075015}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 1152.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-00", "timestamp": 1761044760, "time_this_iter_s": 0.5586466789245605, "time_total_s": 2.338017225265503, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x000002611B9BC900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.338017225265503, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 26.2, "ram_util_percent": 54.5}}
{"timers": {"training_iteration": 0.49229611798097217, "restore_env_runners": 1.6693476141900177e-05, "training_step": 0.492015477120433, "env_runner_sampling_timer": 0.1619043588730663, "learner_update_timer": 0.3213637713596601, "synch_weights": 0.007844212057287225, "synch_env_connectors": 0.0025702118177643282}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.3162670271203265e-05, "agent_to_module_mapping": 4.571635285381295e-06, "batch_individual_items": 1.771525658427591e-05, "add_time_dim_to_batch_and_zero_pad": 7.224719816023167e-06, "add_observations_from_episodes_to_batch": 2.2118061162247776e-05, "add_states_from_episodes_to_batch": 3.257302880930519e-06}}, "connector_pipeline_timer": 0.0001365097772609074}, "num_agent_steps_sampled_lifetime": {"player_0": 352.0, "player_2": 352.0, "player_3": 352.0, "player_1": 352.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.4431622173170956e-05, "remove_single_ts_time_rank_from_batch": 1.3834981418328688e-06, "listify_data_for_vector_env": 6.509804724308757e-06, "get_actions": 0.00020506199101754042, "un_batch_to_individual_items": 1.7931559226932575e-05, "normalize_and_clip_actions": 2.6620095851495953e-05, "module_to_agent_unmapping": 3.6953596108268838e-06}}, "connector_pipeline_timer": 0.00038074138958298694}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.82241230160636, "num_module_steps_sampled_lifetime": {"player_0": 1408.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07210504956794561, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.193591694542692e-05, "env_to_module_sum_episodes_length_out": 35.82241230160636, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.03376676310792315, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 1408.0, "rlmodule_inference_timer": 0.00020137450100832019, "num_env_steps_sampled_lifetime_throughput": 337.0891726853989}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005258301495430558, "add_time_dim_to_batch_and_zero_pad": 1.5818624812712657e-05, "add_columns_from_episodes_to_train_batch": 0.0032692841714969346, "agent_to_module_mapping": 0.00017818135097297317, "add_observations_from_episodes_to_batch": 0.00021812316053824207, "add_states_from_episodes_to_batch": 6.550427673842059e-06, "add_one_ts_to_episodes_and_truncate": 0.002019480145419457, "numpy_to_tensor": 0.00023397612178733979, "batch_individual_items": 0.0040139697288501105}}, "connector_pipeline_timer": 0.015596650707181166}, "num_module_steps_trained_lifetime": 6976, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 27904, "num_env_steps_trained_lifetime_throughput": 10527.650496169992, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2631.8508628873033}, "player_0": {"policy_loss": -0.2610444724559784, "vf_loss_unclipped": 0.00019869394600391388, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.0062500000931322575, "vf_explained_var": -0.0484013557434082, "total_loss": -0.33647438883781433, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.555541515350342, "vf_loss": 0.00019869394600391388, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002093152143061161, "num_module_steps_trained_lifetime": 6976, "num_module_steps_trained_lifetime_throughput": 2631.9171577189086}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 1408.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-00", "timestamp": 1761044760, "time_this_iter_s": 0.4661829471588135, "time_total_s": 2.8042001724243164, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2B60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.8042001724243164, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.9, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.49202735380136237, "restore_env_runners": 1.6638541069151216e-05, "training_step": 0.4917457943490043, "env_runner_sampling_timer": 0.16185652428429353, "learner_update_timer": 0.321157256646052, "synch_weights": 0.007829528936754943, "synch_env_connectors": 0.002568771699811238}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.443286592668516e-05, "agent_to_module_mapping": 4.735348939941735e-06, "batch_individual_items": 1.8307570098015273e-05, "add_time_dim_to_batch_and_zero_pad": 7.263280210218084e-06, "add_observations_from_episodes_to_batch": 2.319621664924246e-05, "add_states_from_episodes_to_batch": 3.2819279377329726e-06}}, "connector_pipeline_timer": 0.00013992626690232193}, "num_agent_steps_sampled_lifetime": {"player_0": 416.0, "player_2": 416.0, "player_3": 416.0, "player_1": 416.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.3696559651333484e-05, "remove_single_ts_time_rank_from_batch": 1.3991809836519897e-06, "listify_data_for_vector_env": 6.645116415179722e-06, "get_actions": 0.0002052037867126679, "un_batch_to_individual_items": 1.802495732129712e-05, "normalize_and_clip_actions": 2.623611016048462e-05, "module_to_agent_unmapping": 3.841452575523391e-06}}, "connector_pipeline_timer": 0.00038016751166824705}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.88309144318504, "num_module_steps_sampled_lifetime": {"player_0": 1664.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07193281303913604, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.326825888246706e-05, "env_to_module_sum_episodes_length_out": 35.88309144318504, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.03664910259944057, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 1664.0, "rlmodule_inference_timer": 0.00019940420462786178, "num_env_steps_sampled_lifetime_throughput": 346.1826551835704}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005217753480148576, "add_time_dim_to_batch_and_zero_pad": 1.5827438672052702e-05, "add_columns_from_episodes_to_train_batch": 0.0032701353296708995, "agent_to_module_mapping": 0.0001780785374422924, "add_observations_from_episodes_to_batch": 0.00021725792905823057, "add_states_from_episodes_to_batch": 6.5219230967632835e-06, "add_one_ts_to_episodes_and_truncate": 0.002012035344425336, "numpy_to_tensor": 0.00023325136006118778, "batch_individual_items": 0.004002888031634446}}, "connector_pipeline_timer": 0.015534328200117124}, "num_module_steps_trained_lifetime": 8384, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 33536, "num_env_steps_trained_lifetime_throughput": 10589.462841858927, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2647.3618225337727}, "player_0": {"policy_loss": -0.07797554135322571, "vf_loss_unclipped": 6.263417890295386e-05, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.0031250000465661287, "vf_explained_var": -1.0, "total_loss": -0.15343298017978668, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.550004005432129, "vf_loss": 6.263417890295386e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0018053450621664524, "num_module_steps_trained_lifetime": 8384, "num_module_steps_trained_lifetime_throughput": 2647.372259664234}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 1664.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-01", "timestamp": 1761044761, "time_this_iter_s": 0.4705018997192383, "time_total_s": 3.2747020721435547, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.2747020721435547, "iterations_since_restore": 6, "perf": {}}
{"timers": {"training_iteration": 0.4914436172638391, "restore_env_runners": 1.658215533190076e-05, "training_step": 0.4911613124056649, "env_runner_sampling_timer": 0.1616796220416012, "learner_update_timer": 0.3207830680798956, "synch_weights": 0.007799659647090279, "synch_env_connectors": 0.00257447998322635}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.211677622679847e-05, "agent_to_module_mapping": 4.5855762842172975e-06, "batch_individual_items": 1.7238014346546107e-05, "add_time_dim_to_batch_and_zero_pad": 6.851221159666077e-06, "add_observations_from_episodes_to_batch": 2.1968789547861434e-05, "add_states_from_episodes_to_batch": 3.1803179869483534e-06}}, "connector_pipeline_timer": 0.00013233722427354264}, "num_agent_steps_sampled_lifetime": {"player_0": 480.0, "player_2": 480.0, "player_3": 480.0, "player_1": 480.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.338957717694696e-05, "remove_single_ts_time_rank_from_batch": 1.3380649178696422e-06, "listify_data_for_vector_env": 6.412893899480803e-06, "get_actions": 0.0001967521573983681, "un_batch_to_individual_items": 1.728243460783932e-05, "normalize_and_clip_actions": 2.4977811902791964e-05, "module_to_agent_unmapping": 3.64784981802953e-06}}, "connector_pipeline_timer": 0.0003659527275316892}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.899854157240696, "num_module_steps_sampled_lifetime": {"player_0": 1920.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07173778513468143, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.117948161432791e-05, "env_to_module_sum_episodes_length_out": 35.899854157240696, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.039486074230044764, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 1920.0, "rlmodule_inference_timer": 0.00018977861752819306, "num_env_steps_sampled_lifetime_throughput": 355.7678608715897}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0051762349456013265, "add_time_dim_to_batch_and_zero_pad": 1.5770163890242787e-05, "add_columns_from_episodes_to_train_batch": 0.00326654297625329, "agent_to_module_mapping": 0.00017780575190899333, "add_observations_from_episodes_to_batch": 0.00021625134991499838, "add_states_from_episodes_to_batch": 6.488704109459438e-06, "add_one_ts_to_episodes_and_truncate": 0.0020026629907488555, "numpy_to_tensor": 0.00023224284664686277, "batch_individual_items": 0.003990239151419504}}, "connector_pipeline_timer": 0.015462222918049724}, "num_module_steps_trained_lifetime": 9792, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 39168, "num_env_steps_trained_lifetime_throughput": 10673.702965746685, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2668.4262277406156}, "player_0": {"policy_loss": -0.026335889473557472, "vf_loss_unclipped": 0.00019772959058173, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0161290168762207, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.0015625000232830644, "vf_explained_var": -1.0, "total_loss": -0.10169029235839844, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.545924186706543, "vf_loss": 0.00019772959058173, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0019144779071211815, "num_module_steps_trained_lifetime": 9792, "num_module_steps_trained_lifetime_throughput": 2668.4325316455925}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 1920.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-01", "timestamp": 1761044761, "time_this_iter_s": 0.43726301193237305, "time_total_s": 3.7119650840759277, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F3100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.7119650840759277, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 24.9, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.4912348350914821, "restore_env_runners": 1.6533333505324257e-05, "training_step": 0.4909518022816261, "env_runner_sampling_timer": 0.16156265182125723, "learner_update_timer": 0.32072769339919466, "synch_weights": 0.0077665960505003614, "synch_env_connectors": 0.0025778181836572855}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.169015438562301e-05, "agent_to_module_mapping": 4.564366368308715e-06, "batch_individual_items": 1.735748279245855e-05, "add_time_dim_to_batch_and_zero_pad": 6.848380234912337e-06, "add_observations_from_episodes_to_batch": 2.2183052353575543e-05, "add_states_from_episodes_to_batch": 3.4553013444174276e-06}}, "connector_pipeline_timer": 0.00013368229433500958}, "num_agent_steps_sampled_lifetime": {"player_0": 544.0, "player_2": 544.0, "player_3": 544.0, "player_1": 544.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.230920277354451e-05, "remove_single_ts_time_rank_from_batch": 1.370638145411699e-06, "listify_data_for_vector_env": 6.482440068847591e-06, "get_actions": 0.00019753454110877343, "un_batch_to_individual_items": 1.7466486105470325e-05, "normalize_and_clip_actions": 2.559071390701016e-05, "module_to_agent_unmapping": 3.6571329313878206e-06}}, "connector_pipeline_timer": 0.00036723048728575105}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.904484884953746, "num_module_steps_sampled_lifetime": {"player_0": 2176.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07150416270312088, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.119652300698316e-05, "env_to_module_sum_episodes_length_out": 35.904484884953746, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.042031593288034845, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 2176.0, "rlmodule_inference_timer": 0.0001873429019796333, "num_env_steps_sampled_lifetime_throughput": 365.63424546397226}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00513603059626006, "add_time_dim_to_batch_and_zero_pad": 1.5741462069456787e-05, "add_columns_from_episodes_to_train_batch": 0.0032636065464342295, "agent_to_module_mapping": 0.00017759269408297674, "add_observations_from_episodes_to_batch": 0.00021526283662411447, "add_states_from_episodes_to_batch": 6.456817319643125e-06, "add_one_ts_to_episodes_and_truncate": 0.00199356536082321, "numpy_to_tensor": 0.00023141141789207158, "batch_individual_items": 0.003977834760323145}}, "connector_pipeline_timer": 0.015392954689199198}, "num_module_steps_trained_lifetime": 11200, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 44800, "num_env_steps_trained_lifetime_throughput": 10709.67061650017, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2677.417021389531}, "player_0": {"policy_loss": -0.07665123045444489, "vf_loss_unclipped": 0.0002630517119541764, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.017241358757019, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.0007812500116415322, "vf_explained_var": 0.2055274248123169, "total_loss": -0.15195517241954803, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.543878555297852, "vf_loss": 0.0002630517119541764, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0021233095321804285, "num_module_steps_trained_lifetime": 11200, "num_module_steps_trained_lifetime_throughput": 2677.4240472051497}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2176.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-02", "timestamp": 1761044762, "time_this_iter_s": 0.4749631881713867, "time_total_s": 4.1869282722473145, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F34C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.1869282722473145, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.9, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.4911361147405417, "restore_env_runners": 1.645300023542634e-05, "training_step": 0.4908527032587966, "env_runner_sampling_timer": 0.1617608223032582, "learner_update_timer": 0.32046581946496044, "synch_weights": 0.007734850089824851, "synch_env_connectors": 0.002579338001879803}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.7586597978989624e-05, "agent_to_module_mapping": 5.08040606828447e-06, "batch_individual_items": 1.9950201352383013e-05, "add_time_dim_to_batch_and_zero_pad": 7.896529980951327e-06, "add_observations_from_episodes_to_batch": 2.433539468016719e-05, "add_states_from_episodes_to_batch": 3.7034220814448947e-06}}, "connector_pipeline_timer": 0.0001519169979274953}, "num_agent_steps_sampled_lifetime": {"player_0": 608.0, "player_2": 608.0, "player_3": 608.0, "player_1": 608.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.105199207645146e-05, "remove_single_ts_time_rank_from_batch": 1.5610376717483156e-06, "listify_data_for_vector_env": 6.945567087874424e-06, "get_actions": 0.0002279121167577835, "un_batch_to_individual_items": 1.959873885601643e-05, "normalize_and_clip_actions": 2.8127627016522413e-05, "module_to_agent_unmapping": 3.957482062605211e-06}}, "connector_pipeline_timer": 0.0004188637562081029}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90576413120714, "num_module_steps_sampled_lifetime": {"player_0": 2432.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07153977718518914, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.627699354561642e-05, "env_to_module_sum_episodes_length_out": 35.90576413120714, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.04475678503386523, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 2432.0, "rlmodule_inference_timer": 0.00024027230981015516, "num_env_steps_sampled_lifetime_throughput": 372.0709221828448}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0050966692902777375, "add_time_dim_to_batch_and_zero_pad": 1.571404785656975e-05, "add_columns_from_episodes_to_train_batch": 0.0032619304809735753, "agent_to_module_mapping": 0.00017746576689276115, "add_observations_from_episodes_to_batch": 0.00021430720864127275, "add_states_from_episodes_to_batch": 6.4292494281829485e-06, "add_one_ts_to_episodes_and_truncate": 0.0019858767073374205, "numpy_to_tensor": 0.0002307223038630938, "batch_individual_items": 0.00396738141307959}}, "connector_pipeline_timer": 0.015329523142224922}, "num_module_steps_trained_lifetime": 12608, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 50432, "num_env_steps_trained_lifetime_throughput": 10740.544870183885, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2685.2082121775074}, "player_0": {"policy_loss": -0.08299803733825684, "vf_loss_unclipped": 8.44711103127338e-05, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.048387050628662, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.0003906250058207661, "vf_explained_var": -0.10700047016143799, "total_loss": -0.15836891531944275, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.541506290435791, "vf_loss": 8.44711103127338e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0024865043815225363, "num_module_steps_trained_lifetime": 12608, "num_module_steps_trained_lifetime_throughput": 2685.1424333400437}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2432.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-02", "timestamp": 1761044762, "time_this_iter_s": 0.48539066314697266, "time_total_s": 4.672318935394287, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F37E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.672318935394287, "iterations_since_restore": 9, "perf": {}}
{"timers": {"training_iteration": 0.4907288675931466, "restore_env_runners": 1.6388469830368193e-05, "training_step": 0.490445053226018, "env_runner_sampling_timer": 0.16149578908013545, "learner_update_timer": 0.3203540342701522, "synch_weights": 0.00770757458894695, "synch_env_connectors": 0.002575528621619964}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.319407335444919e-05, "agent_to_module_mapping": 4.75703714478924e-06, "batch_individual_items": 1.843659444520048e-05, "add_time_dim_to_batch_and_zero_pad": 7.251557874450939e-06, "add_observations_from_episodes_to_batch": 2.3121922883169314e-05, "add_states_from_episodes_to_batch": 3.352983082244753e-06}}, "connector_pipeline_timer": 0.00013906459592507317}, "num_agent_steps_sampled_lifetime": {"player_0": 672.0, "player_2": 672.0, "player_3": 672.0, "player_1": 672.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.852085940344124e-05, "remove_single_ts_time_rank_from_batch": 1.4215595683901967e-06, "listify_data_for_vector_env": 6.6292780935637574e-06, "get_actions": 0.0002067353319129075, "un_batch_to_individual_items": 1.846660005114869e-05, "normalize_and_clip_actions": 2.6496825742306317e-05, "module_to_agent_unmapping": 3.721073109811247e-06}}, "connector_pipeline_timer": 0.0003869647102067311}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906117525118034, "num_module_steps_sampled_lifetime": {"player_0": 2688.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07138904779429432, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.2290995630127324e-05, "env_to_module_sum_episodes_length_out": 35.906117525118034, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.04728257739679668, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 2688.0, "rlmodule_inference_timer": 0.000204337837127203, "num_env_steps_sampled_lifetime_throughput": 381.8648825969757}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005059390597410432, "add_time_dim_to_batch_and_zero_pad": 1.5712907401711798e-05, "add_columns_from_episodes_to_train_batch": 0.003268198175991649, "agent_to_module_mapping": 0.0001780651092562659, "add_observations_from_episodes_to_batch": 0.0002133361367478971, "add_states_from_episodes_to_batch": 6.420957360312748e-06, "add_one_ts_to_episodes_and_truncate": 0.0019774089402713256, "numpy_to_tensor": 0.0002299960806393681, "batch_individual_items": 0.003967339599210712}}, "connector_pipeline_timer": 0.015286960911131438}, "num_module_steps_trained_lifetime": 14016, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 56064, "num_env_steps_trained_lifetime_throughput": 10808.570852409366, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2702.0823194393065}, "player_0": {"policy_loss": -0.0986436977982521, "vf_loss_unclipped": 1.2480857549235225e-05, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 0.00019531250291038305, "vf_explained_var": -0.1748741865158081, "total_loss": -0.17401321232318878, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.5376667976379395, "vf_loss": 1.2480857549235225e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0023231939412653446, "num_module_steps_trained_lifetime": 14016, "num_module_steps_trained_lifetime_throughput": 2702.1462455838173}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2688.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-03", "timestamp": 1761044763, "time_this_iter_s": 0.47156667709350586, "time_total_s": 5.143885612487793, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000ABEC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.143885612487793, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.9, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.49045380791719584, "restore_env_runners": 1.634358545611261e-05, "training_step": 0.4901691526936645, "env_runner_sampling_timer": 0.16156079118908076, "learner_update_timer": 0.32004409492741037, "synch_weights": 0.007680022842972008, "synch_env_connectors": 0.002740866335288623}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.24564414183492e-05, "agent_to_module_mapping": 4.673510829522695e-06, "batch_individual_items": 1.8167064254528934e-05, "add_time_dim_to_batch_and_zero_pad": 7.169298531749853e-06, "add_observations_from_episodes_to_batch": 2.2653635901495836e-05, "add_states_from_episodes_to_batch": 3.331450002425047e-06}}, "connector_pipeline_timer": 0.00013667099336016835}, "num_agent_steps_sampled_lifetime": {"player_0": 736.0, "player_2": 736.0, "player_3": 736.0, "player_1": 736.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.574142910854715e-05, "remove_single_ts_time_rank_from_batch": 1.3953182700037322e-06, "listify_data_for_vector_env": 6.540949366654331e-06, "get_actions": 0.0002067705082943345, "un_batch_to_individual_items": 1.8089432503180143e-05, "normalize_and_clip_actions": 2.5923095618008183e-05, "module_to_agent_unmapping": 3.7407149809170887e-06}}, "connector_pipeline_timer": 0.0003828018863880354}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90621515077528, "num_module_steps_sampled_lifetime": {"player_0": 2944.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07121369191811257, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.1694421327303034e-05, "env_to_module_sum_episodes_length_out": 35.90621515077528, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.050033979466883274, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 2944.0, "rlmodule_inference_timer": 0.00020094464220823418, "num_env_steps_sampled_lifetime_throughput": 387.5169024064745}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.005022522691179074, "add_time_dim_to_batch_and_zero_pad": 1.568877817626908e-05, "add_columns_from_episodes_to_train_batch": 0.0032681991945495074, "agent_to_module_mapping": 0.0001780884585124873, "add_observations_from_episodes_to_batch": 0.00021242077534164533, "add_states_from_episodes_to_batch": 6.397747516827239e-06, "add_one_ts_to_episodes_and_truncate": 0.0019696378508793485, "numpy_to_tensor": 0.00022924812000913594, "batch_individual_items": 0.003960146203154791}}, "connector_pipeline_timer": 0.01523162830198521}, "num_module_steps_trained_lifetime": 15424, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 61696, "num_env_steps_trained_lifetime_throughput": 10834.347955854433, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2708.5629226233177}, "player_0": {"policy_loss": -0.2091667652130127, "vf_loss_unclipped": 1.8813312863130704e-06, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0499999523162842, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 9.765625145519152e-05, "vf_explained_var": 0.5063773393630981, "total_loss": -0.2844700813293457, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.530479907989502, "vf_loss": 1.8813312863130704e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0029169167391955853, "num_module_steps_trained_lifetime": 15424, "num_module_steps_trained_lifetime_throughput": 2708.5917109901966}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 2944.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-03", "timestamp": 1761044763, "time_this_iter_s": 0.4669046401977539, "time_total_s": 5.610790252685547, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F34C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.610790252685547, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.2, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.49020708383840783, "restore_env_runners": 1.6296149902756106e-05, "training_step": 0.48992191816657926, "env_runner_sampling_timer": 0.16145239427703362, "learner_update_timer": 0.31994236297817796, "synch_weights": 0.007647464614400347, "synch_env_connectors": 0.0027361396717709226}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2250811699857154e-05, "agent_to_module_mapping": 4.60122287538801e-06, "batch_individual_items": 1.7878187027424696e-05, "add_time_dim_to_batch_and_zero_pad": 8.411793658008926e-06, "add_observations_from_episodes_to_batch": 2.2921338855096305e-05, "add_states_from_episodes_to_batch": 3.3074947686513943e-06}}, "connector_pipeline_timer": 0.00013890188130724493}, "num_agent_steps_sampled_lifetime": {"player_0": 800.0, "player_2": 800.0, "player_3": 800.0, "player_1": 800.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.416201418027458e-05, "remove_single_ts_time_rank_from_batch": 1.4161874465745718e-06, "listify_data_for_vector_env": 6.415807389045139e-06, "get_actions": 0.0002037444410358909, "un_batch_to_individual_items": 1.7923570070373527e-05, "normalize_and_clip_actions": 2.5785644277314002e-05, "module_to_agent_unmapping": 3.674460676098871e-06}}, "connector_pipeline_timer": 0.00037704717200236324}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906242120025894, "num_module_steps_sampled_lifetime": {"player_0": 3200.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07108449712887793, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.0769035792135174e-05, "env_to_module_sum_episodes_length_out": 35.906242120025894, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.05251170288274597, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 3200.0, "rlmodule_inference_timer": 0.00019426044219568114, "num_env_steps_sampled_lifetime_throughput": 395.52866272650556}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004985106464012458, "add_time_dim_to_batch_and_zero_pad": 1.5750890315850608e-05, "add_columns_from_episodes_to_train_batch": 0.0032707652020802815, "agent_to_module_mapping": 0.000178284573847224, "add_observations_from_episodes_to_batch": 0.0002116245672228971, "add_states_from_episodes_to_batch": 6.3787703843111685e-06, "add_one_ts_to_episodes_and_truncate": 0.0019618644723542085, "numpy_to_tensor": 0.00022841463885913484, "batch_individual_items": 0.0039547767410122595}}, "connector_pipeline_timer": 0.015180010018552641}, "num_module_steps_trained_lifetime": 16832, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 67328, "num_env_steps_trained_lifetime_throughput": 10869.84474121729, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2717.4247468641443}, "player_0": {"policy_loss": -0.24480032920837402, "vf_loss_unclipped": 7.567677471342904e-07, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0333333015441895, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 4.882812572759576e-05, "vf_explained_var": 0.13858479261398315, "total_loss": -0.3200434148311615, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.524367809295654, "vf_loss": 7.567677471342904e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002064933767542243, "num_module_steps_trained_lifetime": 16832, "num_module_steps_trained_lifetime_throughput": 2717.4649317563862}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 3200.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-03", "timestamp": 1761044763, "time_this_iter_s": 0.46927976608276367, "time_total_s": 6.0800700187683105, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.0800700187683105, "iterations_since_restore": 12, "perf": {}}
{"timers": {"training_iteration": 0.4908515140000863, "restore_env_runners": 1.6235188598330258e-05, "training_step": 0.4905657849845839, "env_runner_sampling_timer": 0.16199007633443674, "learner_update_timer": 0.32006043134845635, "synch_weights": 0.007639149968629953, "synch_env_connectors": 0.002737608275136176}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.166028926271078e-05, "agent_to_module_mapping": 5.725797548035697e-06, "batch_individual_items": 2.1477623470808155e-05, "add_time_dim_to_batch_and_zero_pad": 8.485964371124993e-06, "add_observations_from_episodes_to_batch": 2.5620975351943303e-05, "add_states_from_episodes_to_batch": 3.98232765137882e-06}}, "connector_pipeline_timer": 0.00016733470581330303}, "num_agent_steps_sampled_lifetime": {"player_0": 864.0, "player_2": 864.0, "player_3": 864.0, "player_1": 864.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.501465139098363e-05, "remove_single_ts_time_rank_from_batch": 1.6824190741352747e-06, "listify_data_for_vector_env": 7.3915837678789404e-06, "get_actions": 0.00024595103319029085, "un_batch_to_individual_items": 2.162943397678098e-05, "normalize_and_clip_actions": 3.0468028162922824e-05, "module_to_agent_unmapping": 4.394062601364827e-06}}, "connector_pipeline_timer": 0.00045670939305647845}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90624957032635, "num_module_steps_sampled_lifetime": {"player_0": 3456.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07122949140596023, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.843460237938749e-05, "env_to_module_sum_episodes_length_out": 35.90624957032635, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.0550432697256226, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 3456.0, "rlmodule_inference_timer": 0.00025232217042226135, "num_env_steps_sampled_lifetime_throughput": 399.2107741270596}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004959125399522388, "add_time_dim_to_batch_and_zero_pad": 1.5834381501555174e-05, "add_columns_from_episodes_to_train_batch": 0.00328391554999895, "agent_to_module_mapping": 0.00018044072841633406, "add_observations_from_episodes_to_batch": 0.00021082232166081004, "add_states_from_episodes_to_batch": 6.393982699936424e-06, "add_one_ts_to_episodes_and_truncate": 0.0019544928277531095, "numpy_to_tensor": 0.0002284544927043278, "batch_individual_items": 0.003969179973465583}}, "connector_pipeline_timer": 0.015174425918215323}, "num_module_steps_trained_lifetime": 18240, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 72960, "num_env_steps_trained_lifetime_throughput": 10822.528985093399, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2705.6138274986847}, "player_0": {"policy_loss": 0.05028955265879631, "vf_loss_unclipped": 3.811268470599316e-05, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 2.441406286379788e-05, "vf_explained_var": -0.8664511442184448, "total_loss": -0.024859042838215828, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.516775131225586, "vf_loss": 3.811268470599316e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0022603769320994616, "num_module_steps_trained_lifetime": 18240, "num_module_steps_trained_lifetime_throughput": 2705.6372916580995}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 3456.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-04", "timestamp": 1761044764, "time_this_iter_s": 0.5691032409667969, "time_total_s": 6.649173259735107, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.649173259735107, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.1, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.4913781838606187, "restore_env_runners": 1.617783634771554e-05, "training_step": 0.4910917881346313, "env_runner_sampling_timer": 0.1622648205710854, "learner_update_timer": 0.3203354150351185, "synch_weights": 0.00761884946880397, "synch_env_connectors": 0.0028439461924971913}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.1905848831600596e-05, "agent_to_module_mapping": 5.517663177635459e-06, "batch_individual_items": 2.1607166193522633e-05, "add_time_dim_to_batch_and_zero_pad": 8.092522247827789e-06, "add_observations_from_episodes_to_batch": 2.586688603491361e-05, "add_states_from_episodes_to_batch": 4.2084857826654595e-06}}, "connector_pipeline_timer": 0.0001698358478093991}, "num_agent_steps_sampled_lifetime": {"player_0": 928.0, "player_2": 928.0, "player_3": 928.0, "player_1": 928.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.730567860664594e-05, "remove_single_ts_time_rank_from_batch": 1.682605573856067e-06, "listify_data_for_vector_env": 7.536743262740498e-06, "get_actions": 0.00025019318942307576, "un_batch_to_individual_items": 2.2298235344298285e-05, "normalize_and_clip_actions": 3.106237725768891e-05, "module_to_agent_unmapping": 4.469104324741046e-06}}, "connector_pipeline_timer": 0.000466836750452153}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625162848426, "num_module_steps_sampled_lifetime": {"player_0": 3712.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07145940955693039, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.9632513426827646e-05, "env_to_module_sum_episodes_length_out": 35.90625162848426, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.05803512314297212, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 3712.0, "rlmodule_inference_timer": 0.0002507819203937121, "num_env_steps_sampled_lifetime_throughput": 402.0974071195066}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0049238241454899485, "add_time_dim_to_batch_and_zero_pad": 1.5830037695018384e-05, "add_columns_from_episodes_to_train_batch": 0.0032971873940365925, "agent_to_module_mapping": 0.00018062132111294822, "add_observations_from_episodes_to_batch": 0.00021018209798074602, "add_states_from_episodes_to_batch": 6.375042633512652e-06, "add_one_ts_to_episodes_and_truncate": 0.001948788899511915, "numpy_to_tensor": 0.00022794394789763374, "batch_individual_items": 0.003962365173197607}}, "connector_pipeline_timer": 0.015137136659181325}, "num_module_steps_trained_lifetime": 19648, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 78592, "num_env_steps_trained_lifetime_throughput": 10770.144462761558, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2692.5071886838614}, "player_0": {"policy_loss": -0.13565108180046082, "vf_loss_unclipped": 2.3103750663722167e-06, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.220703143189894e-05, "vf_explained_var": 0.13908672332763672, "total_loss": -0.2107461392879486, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.509631156921387, "vf_loss": 2.3103750663722167e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002516112057492137, "num_module_steps_trained_lifetime": 19648, "num_module_steps_trained_lifetime_throughput": 2692.540145375157}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 3712.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-05", "timestamp": 1761044765, "time_this_iter_s": 0.5478847026824951, "time_total_s": 7.1970579624176025, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.1970579624176025, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 28.2, "ram_util_percent": 54.6}}
{"timers": {"training_iteration": 0.49120070902228824, "restore_env_runners": 1.6143057787125828e-05, "training_step": 0.4909129762530043, "env_runner_sampling_timer": 0.16239708936544567, "learner_update_timer": 0.320065166884604, "synch_weights": 0.007582295974400691, "synch_env_connectors": 0.0028504177309748636}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.838878505291522e-05, "agent_to_module_mapping": 5.289613893734493e-06, "batch_individual_items": 2.0820381374967485e-05, "add_time_dim_to_batch_and_zero_pad": 7.967214784390418e-06, "add_observations_from_episodes_to_batch": 2.504179489087911e-05, "add_states_from_episodes_to_batch": 3.983155475854504e-06}}, "connector_pipeline_timer": 0.00015948038140211831}, "num_agent_steps_sampled_lifetime": {"player_0": 992.0, "player_2": 992.0, "player_3": 992.0, "player_1": 992.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.409944763461241e-05, "remove_single_ts_time_rank_from_batch": 1.6195835091955015e-06, "listify_data_for_vector_env": 7.252494282202043e-06, "get_actions": 0.000240468637598581, "un_batch_to_individual_items": 2.1091604088791283e-05, "normalize_and_clip_actions": 3.0097518855701174e-05, "module_to_agent_unmapping": 4.2310509965653485e-06}}, "connector_pipeline_timer": 0.000446015332735531}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252197053824, "num_module_steps_sampled_lifetime": {"player_0": 3968.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07155281933168184, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.773811017663199e-05, "env_to_module_sum_episodes_length_out": 35.906252197053824, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.06101803340518743, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 3968.0, "rlmodule_inference_timer": 0.0002548293881483304, "num_env_steps_sampled_lifetime_throughput": 405.1683050497729}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004887900903558622, "add_time_dim_to_batch_and_zero_pad": 1.579873712095564e-05, "add_columns_from_episodes_to_train_batch": 0.003299556520280643, "agent_to_module_mapping": 0.00018083110811864555, "add_observations_from_episodes_to_batch": 0.0002093202771296846, "add_states_from_episodes_to_batch": 6.357291975367612e-06, "add_one_ts_to_episodes_and_truncate": 0.001941481010711144, "numpy_to_tensor": 0.0002271175084230607, "batch_individual_items": 0.00395714852152303}}, "connector_pipeline_timer": 0.015087309292797889}, "num_module_steps_trained_lifetime": 21056, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 84224, "num_env_steps_trained_lifetime_throughput": 10797.163361671068, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2699.2312544694614}, "player_0": {"policy_loss": -0.20544090867042542, "vf_loss_unclipped": 2.7158064312970964e-06, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 6.10351571594947e-06, "vf_explained_var": 0.1964818239212036, "total_loss": -0.2804909348487854, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.505141258239746, "vf_loss": 2.7158064312970964e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002504357136785984, "num_module_steps_trained_lifetime": 21056, "num_module_steps_trained_lifetime_throughput": 2699.293362554685}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 3968.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-05", "timestamp": 1761044765, "time_this_iter_s": 0.47636866569519043, "time_total_s": 7.673426628112793, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.673426628112793, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.7, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4909436499315809, "restore_env_runners": 1.6080626798936195e-05, "training_step": 0.490655495490481, "env_runner_sampling_timer": 0.1621210724714391, "learner_update_timer": 0.3201125222158327, "synch_weights": 0.007556921014622084, "synch_env_connectors": 0.0028417205537275433}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2113610488487876e-05, "agent_to_module_mapping": 5.782029472479709e-06, "batch_individual_items": 1.778437581608497e-05, "add_time_dim_to_batch_and_zero_pad": 7.286711930353104e-06, "add_observations_from_episodes_to_batch": 2.1824425712268334e-05, "add_states_from_episodes_to_batch": 3.379552613351776e-06}}, "connector_pipeline_timer": 0.00013619606309426275}, "num_agent_steps_sampled_lifetime": {"player_0": 1056.0, "player_2": 1056.0, "player_3": 1056.0, "player_1": 1056.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.427850686054686e-05, "remove_single_ts_time_rank_from_batch": 1.5544500576365394e-06, "listify_data_for_vector_env": 6.670514929583245e-06, "get_actions": 0.00020235442013659833, "un_batch_to_individual_items": 1.8402775415280526e-05, "normalize_and_clip_actions": 2.6276511095646837e-05, "module_to_agent_unmapping": 3.843834489343316e-06}}, "connector_pipeline_timer": 0.0003796032323701771}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625235412213, "num_module_steps_sampled_lifetime": {"player_0": 4224.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07129132462964469, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.132128113099884e-05, "env_to_module_sum_episodes_length_out": 35.90625235412213, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.06320220596517132, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 4224.0, "rlmodule_inference_timer": 0.00019251174852919127, "num_env_steps_sampled_lifetime_throughput": 413.3722149060544}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004849945894466806, "add_time_dim_to_batch_and_zero_pad": 1.5775749613549474e-05, "add_columns_from_episodes_to_train_batch": 0.003296165955241265, "agent_to_module_mapping": 0.0001806357970960281, "add_observations_from_episodes_to_batch": 0.0002085530745599036, "add_states_from_episodes_to_batch": 6.332719352579178e-06, "add_one_ts_to_episodes_and_truncate": 0.0019334632006569987, "numpy_to_tensor": 0.0002262633336511882, "batch_individual_items": 0.0039441300359327825}}, "connector_pipeline_timer": 0.015020670200402798}, "num_module_steps_trained_lifetime": 22464, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 89856, "num_env_steps_trained_lifetime_throughput": 10842.392368654246, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2710.534647802828}, "player_0": {"policy_loss": -0.28642982244491577, "vf_loss_unclipped": 4.371126578917028e-06, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0322580337524414, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 3.051757857974735e-06, "vf_explained_var": -0.2995797395706177, "total_loss": -0.36143606901168823, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.500842571258545, "vf_loss": 4.371126578917028e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0025524096563458443, "num_module_steps_trained_lifetime": 22464, "num_module_steps_trained_lifetime_throughput": 2710.604256816319}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4224.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-06", "timestamp": 1761044766, "time_this_iter_s": 0.4692652225494385, "time_total_s": 8.142691850662231, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.142691850662231, "iterations_since_restore": 16, "perf": {}}
{"timers": {"training_iteration": 0.4910800474320218, "restore_env_runners": 1.6029820786464493e-05, "training_step": 0.4907912235356514, "env_runner_sampling_timer": 0.16234961074653642, "learner_update_timer": 0.3200429369934146, "synch_weights": 0.007537529804416564, "synch_env_connectors": 0.002833262348245946}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.37954995964608e-05, "agent_to_module_mapping": 5.107450207931401e-06, "batch_individual_items": 1.859680612213115e-05, "add_time_dim_to_batch_and_zero_pad": 7.60169016529831e-06, "add_observations_from_episodes_to_batch": 2.262931361418831e-05, "add_states_from_episodes_to_batch": 3.436159852159227e-06}}, "connector_pipeline_timer": 0.00014094340381513642}, "num_agent_steps_sampled_lifetime": {"player_0": 1120.0, "player_2": 1120.0, "player_3": 1120.0, "player_1": 1120.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.777995369163192e-05, "remove_single_ts_time_rank_from_batch": 1.495575934115477e-06, "listify_data_for_vector_env": 6.709370259536266e-06, "get_actions": 0.0002143662609061308, "un_batch_to_individual_items": 1.8857227053730217e-05, "normalize_and_clip_actions": 2.7087139130653213e-05, "module_to_agent_unmapping": 3.866998496592093e-06}}, "connector_pipeline_timer": 0.00039731117218588807}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625239751252, "num_module_steps_sampled_lifetime": {"player_0": 4480.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07122887401717481, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.31529578348309e-05, "env_to_module_sum_episodes_length_out": 35.90625239751252, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.06576520700624053, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 4480.0, "rlmodule_inference_timer": 0.0002131161507662759, "num_env_steps_sampled_lifetime_throughput": 416.54928238293303}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004814452435603214, "add_time_dim_to_batch_and_zero_pad": 1.57479919431449e-05, "add_columns_from_episodes_to_train_batch": 0.0032988032955095017, "agent_to_module_mapping": 0.00018042443904657597, "add_observations_from_episodes_to_batch": 0.00020774554365032475, "add_states_from_episodes_to_batch": 6.307391866327525e-06, "add_one_ts_to_episodes_and_truncate": 0.0019250115688640814, "numpy_to_tensor": 0.00022577069982249095, "batch_individual_items": 0.0039427017357311165}}, "connector_pipeline_timer": 0.014974362497912829}, "num_module_steps_trained_lifetime": 23872, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 95488, "num_env_steps_trained_lifetime_throughput": 10836.615903165995, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2709.14188629527}, "player_0": {"policy_loss": -0.06987272202968597, "vf_loss_unclipped": 1.9622902982519008e-05, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0166666507720947, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.5258789289873675e-06, "vf_explained_var": -0.5767849683761597, "total_loss": -0.14483852684497833, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.49756383895874, "vf_loss": 1.9622902982519008e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002466341247782111, "num_module_steps_trained_lifetime": 23872, "num_module_steps_trained_lifetime_throughput": 2709.1593725193884}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4480.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-06", "timestamp": 1761044766, "time_this_iter_s": 0.5082488059997559, "time_total_s": 8.650940656661987, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.650940656661987, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.0, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.49085319795803534, "restore_env_runners": 1.597652222919742e-05, "training_step": 0.4905638323007044, "env_runner_sampling_timer": 0.1622800436389998, "learner_update_timer": 0.31992725662316174, "synch_weights": 0.0074993255065214995, "synch_env_connectors": 0.0028257637250790036}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2219243675175765e-05, "agent_to_module_mapping": 4.732161327659854e-06, "batch_individual_items": 1.8442350188767758e-05, "add_time_dim_to_batch_and_zero_pad": 6.8497017939629256e-06, "add_observations_from_episodes_to_batch": 2.1778328779810147e-05, "add_states_from_episodes_to_batch": 3.2361042614595314e-06}}, "connector_pipeline_timer": 0.0001360028056315232}, "num_agent_steps_sampled_lifetime": {"player_0": 1184.0, "player_2": 1184.0, "player_3": 1184.0, "player_1": 1184.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.473420075239279e-05, "remove_single_ts_time_rank_from_batch": 1.4110725888545343e-06, "listify_data_for_vector_env": 7.2254408413862865e-06, "get_actions": 0.0002030396063389255, "un_batch_to_individual_items": 1.814262314005317e-05, "normalize_and_clip_actions": 2.552199471727671e-05, "module_to_agent_unmapping": 3.732141005905212e-06}}, "connector_pipeline_timer": 0.0003782338360463389}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252409499174, "num_module_steps_sampled_lifetime": {"player_0": 4736.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07102655515393883, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.117491759022175e-05, "env_to_module_sum_episodes_length_out": 35.906252409499174, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.06813698457182749, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 4736.0, "rlmodule_inference_timer": 0.00018428321252824285, "num_env_steps_sampled_lifetime_throughput": 421.786419785602}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004779504911036398, "add_time_dim_to_batch_and_zero_pad": 1.5765512192096572e-05, "add_columns_from_episodes_to_train_batch": 0.0033055252622461017, "agent_to_module_mapping": 0.00018099119466569912, "add_observations_from_episodes_to_batch": 0.00020690608832733855, "add_states_from_episodes_to_batch": 6.294318328388918e-06, "add_one_ts_to_episodes_and_truncate": 0.0019184174529197516, "numpy_to_tensor": 0.0002251349929513655, "batch_individual_items": 0.00393964171822162}}, "connector_pipeline_timer": 0.014933585872620956}, "num_module_steps_trained_lifetime": 25280, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 101120, "num_env_steps_trained_lifetime_throughput": 10873.67070802362, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2718.373830780055}, "player_0": {"policy_loss": -0.11774791032075882, "vf_loss_unclipped": 6.355009531944233e-07, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.048387050628662, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 7.629394644936838e-07, "vf_explained_var": 0.8038111329078674, "total_loss": -0.19266338646411896, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.491581439971924, "vf_loss": 6.355009531944233e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0029779556207358837, "num_module_steps_trained_lifetime": 25280, "num_module_steps_trained_lifetime_throughput": 2718.4195909180753}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4736.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-07", "timestamp": 1761044767, "time_this_iter_s": 0.4746513366699219, "time_total_s": 9.12559199333191, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100164AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.12559199333191, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.0, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.49061448197884205, "restore_env_runners": 1.5948756847865352e-05, "training_step": 0.4903236629775805, "env_runner_sampling_timer": 0.1624977532025025, "learner_update_timer": 0.3194979020569064, "synch_weights": 0.007469627251765409, "synch_env_connectors": 0.002850328087826045}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.621067003763623e-05, "agent_to_module_mapping": 5.0899130764793204e-06, "batch_individual_items": 1.983213163200615e-05, "add_time_dim_to_batch_and_zero_pad": 8.015575995712329e-06, "add_observations_from_episodes_to_batch": 2.378006795723525e-05, "add_states_from_episodes_to_batch": 3.5767731191885104e-06}}, "connector_pipeline_timer": 0.00015076331357864346}, "num_agent_steps_sampled_lifetime": {"player_0": 1248.0, "player_2": 1248.0, "player_3": 1248.0, "player_1": 1248.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.929394170094952e-05, "remove_single_ts_time_rank_from_batch": 1.517971638703465e-06, "listify_data_for_vector_env": 7.215771578465626e-06, "get_actions": 0.00022355627927624566, "un_batch_to_individual_items": 1.9757030624845854e-05, "normalize_and_clip_actions": 2.830260285058421e-05, "module_to_agent_unmapping": 4.051456042543185e-06}}, "connector_pipeline_timer": 0.00041421044091939353}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241281051, "num_module_steps_sampled_lifetime": {"player_0": 4992.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07111593506908229, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.604508158319332e-05, "env_to_module_sum_episodes_length_out": 35.90625241281051, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.07046269863876958, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 4992.0, "rlmodule_inference_timer": 0.0002346346809428414, "num_env_steps_sampled_lifetime_throughput": 425.1262767015288}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004743091861864782, "add_time_dim_to_batch_and_zero_pad": 1.570685665985723e-05, "add_columns_from_episodes_to_train_batch": 0.0033015700100162866, "agent_to_module_mapping": 0.00018065828290619325, "add_observations_from_episodes_to_batch": 0.00020592502757956144, "add_states_from_episodes_to_batch": 6.262375381154323e-06, "add_one_ts_to_episodes_and_truncate": 0.0019097152784611781, "numpy_to_tensor": 0.0002241776429797039, "batch_individual_items": 0.003927215300929246}}, "connector_pipeline_timer": 0.014867384013618687}, "num_module_steps_trained_lifetime": 26688, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 106752, "num_env_steps_trained_lifetime_throughput": 10901.850792079029, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2725.4098092062313}, "player_0": {"policy_loss": -0.1696968376636505, "vf_loss_unclipped": 1.0989500509595018e-07, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0166666507720947, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 3.814697322468419e-07, "vf_explained_var": 0.9390138387680054, "total_loss": -0.24455608427524567, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.485928535461426, "vf_loss": 1.0989500509595018e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002438089344650507, "num_module_steps_trained_lifetime": 26688, "num_module_steps_trained_lifetime_throughput": 2725.464109772023}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 4992.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-07", "timestamp": 1761044767, "time_this_iter_s": 0.47047853469848633, "time_total_s": 9.596070528030396, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.596070528030396, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.2, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.49031144715907915, "restore_env_runners": 1.5908269021358193e-05, "training_step": 0.49001998134753616, "env_runner_sampling_timer": 0.1623025886706182, "learner_update_timer": 0.31942920403677827, "synch_weights": 0.007432270978937476, "synch_env_connectors": 0.0028456938070902248}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2999898872433544e-05, "agent_to_module_mapping": 4.677382608595966e-06, "batch_individual_items": 1.804721002224703e-05, "add_time_dim_to_batch_and_zero_pad": 7.262967001305462e-06, "add_observations_from_episodes_to_batch": 2.2049721405002313e-05, "add_states_from_episodes_to_batch": 3.5697701308498967e-06}}, "connector_pipeline_timer": 0.00013828868521689573}, "num_agent_steps_sampled_lifetime": {"player_0": 1312.0, "player_2": 1312.0, "player_3": 1312.0, "player_1": 1312.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.3003496478978955e-05, "remove_single_ts_time_rank_from_batch": 1.3858825912633728e-06, "listify_data_for_vector_env": 6.579538384206729e-06, "get_actions": 0.00020299625483297695, "un_batch_to_individual_items": 1.7966511851749547e-05, "normalize_and_clip_actions": 2.753616525266242e-05, "module_to_agent_unmapping": 3.939244701184423e-06}}, "connector_pipeline_timer": 0.0003778260656704369}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241372528, "num_module_steps_sampled_lifetime": {"player_0": 5248.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07094173429872849, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.1931401793778406e-05, "env_to_module_sum_episodes_length_out": 35.90625241372528, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.07239851704570666, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 5248.0, "rlmodule_inference_timer": 0.00019999837898202255, "num_env_steps_sampled_lifetime_throughput": 432.4880171469816}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004708082942954884, "add_time_dim_to_batch_and_zero_pad": 1.565978834877632e-05, "add_columns_from_episodes_to_train_batch": 0.003304223310269788, "agent_to_module_mapping": 0.00018070070018649096, "add_observations_from_episodes_to_batch": 0.00020516977733776282, "add_states_from_episodes_to_batch": 6.237751916693528e-06, "add_one_ts_to_episodes_and_truncate": 0.0019032271256450726, "numpy_to_tensor": 0.00022341386616259585, "batch_individual_items": 0.003921387148211592}}, "connector_pipeline_timer": 0.014819048173821025}, "num_module_steps_trained_lifetime": 28096, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 112384, "num_env_steps_trained_lifetime_throughput": 10939.751454730107, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2734.8836967698103}, "player_0": {"policy_loss": -0.07971165329217911, "vf_loss_unclipped": 2.2193657400748634e-07, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.9073486612342094e-07, "vf_explained_var": 0.9064964056015015, "total_loss": -0.1545277237892151, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.481617450714111, "vf_loss": 2.2193657400748634e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0023686871863901615, "num_module_steps_trained_lifetime": 28096, "num_module_steps_trained_lifetime_throughput": 2734.940110065161}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5248.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 20, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-08", "timestamp": 1761044768, "time_this_iter_s": 0.4634430408477783, "time_total_s": 10.059513568878174, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261001642C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.059513568878174, "iterations_since_restore": 20, "perf": {}}
{"timers": {"training_iteration": 0.49013938368790555, "restore_env_runners": 1.5842186457215883e-05, "training_step": 0.48984719453355197, "env_runner_sampling_timer": 0.1624867477838371, "learner_update_timer": 0.3190965489962886, "synch_weights": 0.007411032269394701, "synch_env_connectors": 0.0028435408690766027}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.5735628418252354e-05, "agent_to_module_mapping": 5.134554453049856e-06, "batch_individual_items": 1.9199856705140555e-05, "add_time_dim_to_batch_and_zero_pad": 7.646001568509077e-06, "add_observations_from_episodes_to_batch": 2.3758138677119435e-05, "add_states_from_episodes_to_batch": 3.6905959357225806e-06}}, "connector_pipeline_timer": 0.0001469371684651034}, "num_agent_steps_sampled_lifetime": {"player_0": 1376.0, "player_2": 1376.0, "player_3": 1376.0, "player_1": 1376.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.818805616196161e-05, "remove_single_ts_time_rank_from_batch": 1.4638519152619676e-06, "listify_data_for_vector_env": 6.78894044440558e-06, "get_actions": 0.00022429855752770277, "un_batch_to_individual_items": 1.92298554300193e-05, "normalize_and_clip_actions": 2.7593369725365007e-05, "module_to_agent_unmapping": 3.974676727995433e-06}}, "connector_pipeline_timer": 0.00041282569395560546}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241397798, "num_module_steps_sampled_lifetime": {"player_0": 5504.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.0709597825485963, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.477584954478253e-05, "env_to_module_sum_episodes_length_out": 35.90625241397798, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.0745154936693835, "weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 5504.0, "rlmodule_inference_timer": 0.00022869040001066858, "num_env_steps_sampled_lifetime_throughput": 435.72718715596955}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004672065113363367, "add_time_dim_to_batch_and_zero_pad": 1.56291902605615e-05, "add_columns_from_episodes_to_train_batch": 0.003303332076926414, "agent_to_module_mapping": 0.00018041969316281075, "add_observations_from_episodes_to_batch": 0.00020434107956368482, "add_states_from_episodes_to_batch": 6.205374625961393e-06, "add_one_ts_to_episodes_and_truncate": 0.0018962318540761743, "numpy_to_tensor": 0.00022259672723125144, "batch_individual_items": 0.00390930227666587}}, "connector_pipeline_timer": 0.01475882069190632}, "num_module_steps_trained_lifetime": 29504, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 118016, "num_env_steps_trained_lifetime_throughput": 10969.53011589927, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2742.3499149061818}, "player_0": {"policy_loss": -0.14313772320747375, "vf_loss_unclipped": 8.880776931619039e-07, "weights_seq_no": 21.0, "diff_num_grad_updates_vs_sampler_policy": 1.049180269241333, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 9.536743306171047e-08, "vf_explained_var": 0.4181152582168579, "total_loss": -0.21792611479759216, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.478882312774658, "vf_loss": 8.880776931619039e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002398079028353095, "num_module_steps_trained_lifetime": 29504, "num_module_steps_trained_lifetime_throughput": 2742.386641789022}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5504.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 21, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-08", "timestamp": 1761044768, "time_this_iter_s": 0.48314452171325684, "time_total_s": 10.54265809059143, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261001651C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.54265809059143, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 20.9, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.48978993385144015, "restore_env_runners": 1.579276484054689e-05, "training_step": 0.48949672758832247, "env_runner_sampling_timer": 0.16225902130590542, "learner_update_timer": 0.31899692750616604, "synch_weights": 0.0073912369470075685, "synch_env_connectors": 0.0028984584606131986}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.3888433727144184e-05, "agent_to_module_mapping": 4.619316693748612e-06, "batch_individual_items": 1.7301647272915577e-05, "add_time_dim_to_batch_and_zero_pad": 6.974328793670532e-06, "add_observations_from_episodes_to_batch": 2.2426803550195545e-05, "add_states_from_episodes_to_batch": 3.3031151359121445e-06}}, "connector_pipeline_timer": 0.00013598400351696454}, "num_agent_steps_sampled_lifetime": {"player_0": 1440.0, "player_2": 1440.0, "player_3": 1440.0, "player_1": 1440.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.417303763180429e-05, "remove_single_ts_time_rank_from_batch": 1.3470331684702818e-06, "listify_data_for_vector_env": 6.707302575163706e-06, "get_actions": 0.00020225052950831096, "un_batch_to_individual_items": 1.7887874395037102e-05, "normalize_and_clip_actions": 2.599021917414651e-05, "module_to_agent_unmapping": 3.6948941872735893e-06}}, "connector_pipeline_timer": 0.0003767883819604263}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252414047785, "num_module_steps_sampled_lifetime": {"player_0": 5760.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07075401944584138, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.237598260130528e-05, "env_to_module_sum_episodes_length_out": 35.906252414047785, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.07652785911278666, "weights_seq_no": 21.0, "num_env_steps_sampled_lifetime": 5760.0, "rlmodule_inference_timer": 0.00019233598212391162, "num_env_steps_sampled_lifetime_throughput": 442.04283369030446}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004637565462154199, "add_time_dim_to_batch_and_zero_pad": 1.5598898153228828e-05, "add_columns_from_episodes_to_train_batch": 0.003299318756522713, "agent_to_module_mapping": 0.0001811084960055865, "add_observations_from_episodes_to_batch": 0.00020341766914720803, "add_states_from_episodes_to_batch": 6.17932115382354e-06, "add_one_ts_to_episodes_and_truncate": 0.0018886885357558977, "numpy_to_tensor": 0.0002225677603898358, "batch_individual_items": 0.0038975712538635524}}, "connector_pipeline_timer": 0.014698556485183787}, "num_module_steps_trained_lifetime": 30912, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 123648, "num_env_steps_trained_lifetime_throughput": 11009.66834630123, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2752.39234750862}, "player_0": {"policy_loss": -0.30489787459373474, "vf_loss_unclipped": 6.983361799939303e-07, "weights_seq_no": 22.0, "diff_num_grad_updates_vs_sampler_policy": 1.048387050628662, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 4.7683716530855236e-08, "vf_explained_var": 0.5020650625228882, "total_loss": -0.3796616792678833, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.476411819458008, "vf_loss": 6.983361799939303e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0018916055560112, "num_module_steps_trained_lifetime": 30912, "num_module_steps_trained_lifetime_throughput": 2752.424161963415}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 5760.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 22, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-09", "timestamp": 1761044769, "time_this_iter_s": 0.45937514305114746, "time_total_s": 11.002033233642578, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100165440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.002033233642578, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 20.4, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4897424985134088, "restore_env_runners": 1.5734837371514148e-05, "training_step": 0.4894488883125496, "env_runner_sampling_timer": 0.16247278509310742, "learner_update_timer": 0.3187651792306759, "synch_weights": 0.007365232577370607, "synch_env_connectors": 0.0028990218757364693}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.36042542948996e-05, "agent_to_module_mapping": 4.561022585695908e-06, "batch_individual_items": 1.8433985892526395e-05, "add_time_dim_to_batch_and_zero_pad": 6.765652144405859e-06, "add_observations_from_episodes_to_batch": 2.204109147436971e-05, "add_states_from_episodes_to_batch": 3.2602162019623056e-06}}, "connector_pipeline_timer": 0.0001398549683180017}, "num_agent_steps_sampled_lifetime": {"player_0": 1504.0, "player_2": 1504.0, "player_3": 1504.0, "player_1": 1504.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.384835490573048e-05, "remove_single_ts_time_rank_from_batch": 1.3772725448564378e-06, "listify_data_for_vector_env": 6.544540889417184e-06, "get_actions": 0.0002001725104893441, "un_batch_to_individual_items": 1.839530722667254e-05, "normalize_and_clip_actions": 2.563008940481327e-05, "module_to_agent_unmapping": 3.755938689928121e-06}}, "connector_pipeline_timer": 0.0003738289053999887}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241406707, "num_module_steps_sampled_lifetime": {"player_0": 6016.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07058253989883781, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.2106220849372826e-05, "env_to_module_sum_episodes_length_out": 35.90625241406707, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.07867103106905246, "weights_seq_no": 22.0, "num_env_steps_sampled_lifetime": 6016.0, "rlmodule_inference_timer": 0.00019225128325238785, "num_env_steps_sampled_lifetime_throughput": 444.61067318783654}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004603656807584059, "add_time_dim_to_batch_and_zero_pad": 1.5618909347694152e-05, "add_columns_from_episodes_to_train_batch": 0.003302159569403388, "agent_to_module_mapping": 0.00018113741108635983, "add_observations_from_episodes_to_batch": 0.00020299949253714845, "add_states_from_episodes_to_batch": 6.153528216407066e-06, "add_one_ts_to_episodes_and_truncate": 0.0018823366503854491, "numpy_to_tensor": 0.0002223930826871949, "batch_individual_items": 0.0038886395413386485}}, "connector_pipeline_timer": 0.014649879920354658}, "num_module_steps_trained_lifetime": 32320, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 129280, "num_env_steps_trained_lifetime_throughput": 11016.171190275223, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2754.02072765186}, "player_0": {"policy_loss": -0.018890203908085823, "vf_loss_unclipped": 2.176842281187419e-05, "weights_seq_no": 23.0, "diff_num_grad_updates_vs_sampler_policy": 1.0161290168762207, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 2.3841858265427618e-08, "vf_explained_var": -1.0, "total_loss": -0.09358725696802139, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.470794677734375, "vf_loss": 2.176842281187419e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0025066304951906204, "num_module_steps_trained_lifetime": 32320, "num_module_steps_trained_lifetime_throughput": 2754.0451676779076}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6016.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 23, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-09", "timestamp": 1761044769, "time_this_iter_s": 0.48977136611938477, "time_total_s": 11.491804599761963, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100165620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.491804599761963, "iterations_since_restore": 23, "perf": {}}
{"timers": {"training_iteration": 0.4893786705281016, "restore_env_runners": 1.5664488496106712e-05, "training_step": 0.48908468442964315, "env_runner_sampling_timer": 0.162252176242248, "learner_update_timer": 0.31864482043784526, "synch_weights": 0.007342704252053085, "synch_env_connectors": 0.0028960746567952317}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.286049267231757e-05, "agent_to_module_mapping": 4.446858263440586e-06, "batch_individual_items": 1.8326208298865458e-05, "add_time_dim_to_batch_and_zero_pad": 6.611179963867696e-06, "add_observations_from_episodes_to_batch": 2.1516090215627837e-05, "add_states_from_episodes_to_batch": 3.1472448866515815e-06}}, "connector_pipeline_timer": 0.00013568517596944483}, "num_agent_steps_sampled_lifetime": {"player_0": 1568.0, "player_2": 1568.0, "player_3": 1568.0, "player_1": 1568.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.1442294036534067e-05, "remove_single_ts_time_rank_from_batch": 1.3425891283315073e-06, "listify_data_for_vector_env": 6.37975625181549e-06, "get_actions": 0.0001959768151181533, "un_batch_to_individual_items": 1.7816257617468943e-05, "normalize_and_clip_actions": 2.5303984694525217e-05, "module_to_agent_unmapping": 3.6509042533917084e-06}}, "connector_pipeline_timer": 0.0003647442949255917}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252414072384, "num_module_steps_sampled_lifetime": {"player_0": 6272.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07042583374969999, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.1440286803243524e-05, "env_to_module_sum_episodes_length_out": 35.906252414072384, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.08069560499555635, "weights_seq_no": 23.0, "num_env_steps_sampled_lifetime": 6272.0, "rlmodule_inference_timer": 0.0001850883116269555, "num_env_steps_sampled_lifetime_throughput": 450.14386071548256}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004571457239514096, "add_time_dim_to_batch_and_zero_pad": 1.5607720194165533e-05, "add_columns_from_episodes_to_train_batch": 0.003298436973871054, "agent_to_module_mapping": 0.0001811080365746848, "add_observations_from_episodes_to_batch": 0.0002020744978767196, "add_states_from_episodes_to_batch": 6.133993254051717e-06, "add_one_ts_to_episodes_and_truncate": 0.0018746542837314805, "numpy_to_tensor": 0.00022162515188756975, "batch_individual_items": 0.0038782111460860156}}, "connector_pipeline_timer": 0.014591960121008529}, "num_module_steps_trained_lifetime": 33728, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 134912, "num_env_steps_trained_lifetime_throughput": 11062.138810238588, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2765.7161423516786}, "player_0": {"policy_loss": -0.17694340646266937, "vf_loss_unclipped": 3.4287479593331227e-06, "weights_seq_no": 24.0, "diff_num_grad_updates_vs_sampler_policy": 1.0322580337524414, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.1920929132713809e-08, "vf_explained_var": 0.2458668351173401, "total_loss": -0.25159958004951477, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.465789318084717, "vf_loss": 3.4287479593331227e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0030726564582437277, "num_module_steps_trained_lifetime": 33728, "num_module_steps_trained_lifetime_throughput": 2765.7392335613636}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6272.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 24, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-10", "timestamp": 1761044770, "time_this_iter_s": 0.4584920406341553, "time_total_s": 11.950296640396118, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F3E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.950296640396118, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.1, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4892636088230353, "restore_env_runners": 1.562184331504467e-05, "training_step": 0.4889690415855264, "env_runner_sampling_timer": 0.16229176947989746, "learner_update_timer": 0.3185239092335418, "synch_weights": 0.007312242209562208, "synch_env_connectors": 0.0028986879102496535}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.3482537512400856e-05, "agent_to_module_mapping": 4.837231601132762e-06, "batch_individual_items": 1.892711700008934e-05, "add_time_dim_to_batch_and_zero_pad": 7.225956411218915e-06, "add_observations_from_episodes_to_batch": 2.2507978576820677e-05, "add_states_from_episodes_to_batch": 3.3262922998912544e-06}}, "connector_pipeline_timer": 0.00013994569969616775}, "num_agent_steps_sampled_lifetime": {"player_0": 1632.0, "player_2": 1632.0, "player_3": 1632.0, "player_1": 1632.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.390174086966633e-05, "remove_single_ts_time_rank_from_batch": 1.397406715905008e-06, "listify_data_for_vector_env": 6.582629628272961e-06, "get_actions": 0.00020701844263748583, "un_batch_to_individual_items": 1.814795054355952e-05, "normalize_and_clip_actions": 2.6478829253044405e-05, "module_to_agent_unmapping": 3.766832437299582e-06}}, "connector_pipeline_timer": 0.00038245561094128744}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252414073855, "num_module_steps_sampled_lifetime": {"player_0": 6528.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.0702846253629205, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.2994589901045684e-05, "env_to_module_sum_episodes_length_out": 35.906252414073855, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.08263819029849412, "weights_seq_no": 24.0, "num_env_steps_sampled_lifetime": 6528.0, "rlmodule_inference_timer": 0.00019493379866094624, "num_env_steps_sampled_lifetime_throughput": 453.16475505681126}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004540330667022552, "add_time_dim_to_batch_and_zero_pad": 1.5591642894099732e-05, "add_columns_from_episodes_to_train_batch": 0.003300005604137306, "agent_to_module_mapping": 0.0001813499561254244, "add_observations_from_episodes_to_batch": 0.00020131775320944627, "add_states_from_episodes_to_batch": 6.1106530287853385e-06, "add_one_ts_to_episodes_and_truncate": 0.0018685227403262823, "numpy_to_tensor": 0.00022129290016248434, "batch_individual_items": 0.0038776810342743746}}, "connector_pipeline_timer": 0.014553011519421162}, "num_module_steps_trained_lifetime": 35136, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 140544, "num_env_steps_trained_lifetime_throughput": 11070.748152287635, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2767.671837467749}, "player_0": {"policy_loss": -0.044413838535547256, "vf_loss_unclipped": 2.6256018372805556e-06, "weights_seq_no": 25.0, "diff_num_grad_updates_vs_sampler_policy": 1.034482717514038, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 5.9604645663569045e-09, "vf_explained_var": 0.29373639822006226, "total_loss": -0.11900896579027176, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.459643840789795, "vf_loss": 2.6256018372805556e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0026811575517058372, "num_module_steps_trained_lifetime": 35136, "num_module_steps_trained_lifetime_throughput": 2767.702379254938}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6528.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 25, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-10", "timestamp": 1761044770, "time_this_iter_s": 0.48215270042419434, "time_total_s": 12.432449340820312, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000ABF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.432449340820312, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4889251727343525, "restore_env_runners": 1.5557625000351004e-05, "training_step": 0.4886304031696955, "env_runner_sampling_timer": 0.16207516478499612, "learner_update_timer": 0.3184245431407152, "synch_weights": 0.0072927627878951505, "synch_env_connectors": 0.002898264031525356}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.239066800570971e-05, "agent_to_module_mapping": 4.535757754594981e-06, "batch_individual_items": 1.7663480796730052e-05, "add_time_dim_to_batch_and_zero_pad": 6.884406115026921e-06, "add_observations_from_episodes_to_batch": 2.1653865900416935e-05, "add_states_from_episodes_to_batch": 3.166856873187759e-06}}, "connector_pipeline_timer": 0.00013357806722647601}, "num_agent_steps_sampled_lifetime": {"player_0": 1696.0, "player_2": 1696.0, "player_3": 1696.0, "player_1": 1696.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.295894484451526e-05, "remove_single_ts_time_rank_from_batch": 1.5654070962166441e-06, "listify_data_for_vector_env": 6.3903304165562235e-06, "get_actions": 0.00019956778559331191, "un_batch_to_individual_items": 1.804477214560497e-05, "normalize_and_clip_actions": 2.5182120687368828e-05, "module_to_agent_unmapping": 3.6940641702106594e-06}}, "connector_pipeline_timer": 0.0003700196383189712}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407426, "num_module_steps_sampled_lifetime": {"player_0": 6784.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.07010244615322633, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.147728962511115e-05, "env_to_module_sum_episodes_length_out": 35.90625241407426, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.08460088639163776, "weights_seq_no": 25.0, "num_env_steps_sampled_lifetime": 6784.0, "rlmodule_inference_timer": 0.0001852989256405007, "num_env_steps_sampled_lifetime_throughput": 457.73963856781324}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004508824360815075, "add_time_dim_to_batch_and_zero_pad": 1.5611726641156347e-05, "add_columns_from_episodes_to_train_batch": 0.00330467554797013, "agent_to_module_mapping": 0.000181542456704852, "add_observations_from_episodes_to_batch": 0.00020077257579597247, "add_states_from_episodes_to_batch": 6.093546251458585e-06, "add_one_ts_to_episodes_and_truncate": 0.0018633225131589792, "numpy_to_tensor": 0.00022087797088187996, "batch_individual_items": 0.0038744822235923762}}, "connector_pipeline_timer": 0.014515490404768593}, "num_module_steps_trained_lifetime": 36544, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 146176, "num_env_steps_trained_lifetime_throughput": 11113.694540535591, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2778.4348473894047}, "player_0": {"policy_loss": -0.0650901198387146, "vf_loss_unclipped": 4.429677119333064e-06, "weights_seq_no": 26.0, "diff_num_grad_updates_vs_sampler_policy": 1.0161290168762207, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 2.9802322831784522e-09, "vf_explained_var": 0.21145838499069214, "total_loss": -0.1396426260471344, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.455466270446777, "vf_loss": 4.429677119333064e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0020479464437812567, "num_module_steps_trained_lifetime": 36544, "num_module_steps_trained_lifetime_throughput": 2778.438998917816}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 6784.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 26, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-11", "timestamp": 1761044771, "time_this_iter_s": 0.460094690322876, "time_total_s": 12.892544031143188, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100056F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.892544031143188, "iterations_since_restore": 26, "perf": {}}
{"timers": {"training_iteration": 0.4888058170069342, "restore_env_runners": 1.5532048576078415e-05, "training_step": 0.488510261138013, "env_runner_sampling_timer": 0.16200569613729965, "learner_update_timer": 0.3184064447094644, "synch_weights": 0.007263690159837832, "synch_env_connectors": 0.002902001391227537}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.329223375606409e-05, "agent_to_module_mapping": 4.616150202072342e-06, "batch_individual_items": 1.8073863932865166e-05, "add_time_dim_to_batch_and_zero_pad": 7.123432880678368e-06, "add_observations_from_episodes_to_batch": 2.2293821441270746e-05, "add_states_from_episodes_to_batch": 3.3248277831508316e-06}}, "connector_pipeline_timer": 0.00013763618989937805}, "num_agent_steps_sampled_lifetime": {"player_0": 1760.0, "player_2": 1760.0, "player_3": 1760.0, "player_1": 1760.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.307112120996236e-05, "remove_single_ts_time_rank_from_batch": 1.4491572862205275e-06, "listify_data_for_vector_env": 6.543564909016439e-06, "get_actions": 0.00020497184581823004, "un_batch_to_individual_items": 1.7872481117929e-05, "normalize_and_clip_actions": 2.621428474262587e-05, "module_to_agent_unmapping": 4.0465360693684775e-06}}, "connector_pipeline_timer": 0.0003785535191847358}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407437, "num_module_steps_sampled_lifetime": {"player_0": 7040.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06997226048198381, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.249965574731658e-05, "env_to_module_sum_episodes_length_out": 35.90625241407437, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.08656085629235967, "weights_seq_no": 26.0, "num_env_steps_sampled_lifetime": 7040.0, "rlmodule_inference_timer": 0.00019207557091648146, "num_env_steps_sampled_lifetime_throughput": 460.71982830742706}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004478512116795816, "add_time_dim_to_batch_and_zero_pad": 1.5592609253777158e-05, "add_columns_from_episodes_to_train_batch": 0.003305822792672171, "agent_to_module_mapping": 0.00018159503239183848, "add_observations_from_episodes_to_batch": 0.0002000928502547576, "add_states_from_episodes_to_batch": 6.071610503832631e-06, "add_one_ts_to_episodes_and_truncate": 0.0018580802881296634, "numpy_to_tensor": 0.00022051319124434833, "batch_individual_items": 0.0038711744011077076}}, "connector_pipeline_timer": 0.014474924500250277}, "num_module_steps_trained_lifetime": 37952, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 151808, "num_env_steps_trained_lifetime_throughput": 11118.00562943286, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2779.4779348754687}, "player_0": {"policy_loss": -0.13175061345100403, "vf_loss_unclipped": 3.6068379358766833e-06, "weights_seq_no": 27.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.4901161415892261e-09, "vf_explained_var": 0.5185736417770386, "total_loss": -0.2063007652759552, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.455198764801025, "vf_loss": 3.6068379358766833e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0026351038832217455, "num_module_steps_trained_lifetime": 37952, "num_module_steps_trained_lifetime_throughput": 2779.514527427327}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 7040.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 27, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-11", "timestamp": 1761044771, "time_this_iter_s": 0.48044776916503906, "time_total_s": 13.372991800308228, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F3E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.372991800308228, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.4, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4882813898370251, "restore_env_runners": 1.5466728193545425e-05, "training_step": 0.4879854645265042, "env_runner_sampling_timer": 0.1617698241755509, "learner_update_timer": 0.31814946026230556, "synch_weights": 0.0072353212582954895, "synch_env_connectors": 0.00289667337727409}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.137644024557504e-05, "agent_to_module_mapping": 4.4639832731227975e-06, "batch_individual_items": 1.8196758006279597e-05, "add_time_dim_to_batch_and_zero_pad": 6.605468779732068e-06, "add_observations_from_episodes_to_batch": 2.1111007008001847e-05, "add_states_from_episodes_to_batch": 3.558219481832076e-06}}, "connector_pipeline_timer": 0.0001313651154963455}, "num_agent_steps_sampled_lifetime": {"player_0": 1824.0, "player_2": 1824.0, "player_3": 1824.0, "player_1": 1824.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.254810436606209e-05, "remove_single_ts_time_rank_from_batch": 1.342506646904105e-06, "listify_data_for_vector_env": 6.268151904139483e-06, "get_actions": 0.00019207238743331826, "un_batch_to_individual_items": 1.6947124097938704e-05, "normalize_and_clip_actions": 2.5030514138102463e-05, "module_to_agent_unmapping": 3.811965925242894e-06}}, "connector_pipeline_timer": 0.0003597612769753375}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.906252414074416, "num_module_steps_sampled_lifetime": {"player_0": 7296.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06973048779060502, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 3.995552710461443e-05, "env_to_module_sum_episodes_length_out": 35.906252414074416, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.08843806435718655, "weights_seq_no": 27.0, "num_env_steps_sampled_lifetime": 7296.0, "rlmodule_inference_timer": 0.0001751189996596035, "num_env_steps_sampled_lifetime_throughput": 464.535353878828}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004446676995282523, "add_time_dim_to_batch_and_zero_pad": 1.561868338292396e-05, "add_columns_from_episodes_to_train_batch": 0.003307774564737775, "agent_to_module_mapping": 0.00018164508172464948, "add_observations_from_episodes_to_batch": 0.00019937592163391717, "add_states_from_episodes_to_batch": 6.051894710988533e-06, "add_one_ts_to_episodes_and_truncate": 0.0018526464852389342, "numpy_to_tensor": 0.00021975005925254872, "batch_individual_items": 0.003865598657371311}}, "connector_pipeline_timer": 0.014430603255689527}, "num_module_steps_trained_lifetime": 39360, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 157440, "num_env_steps_trained_lifetime_throughput": 11183.985320254811, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2796.010467786689}, "player_0": {"policy_loss": -0.27357617020606995, "vf_loss_unclipped": 1.207268906000536e-05, "weights_seq_no": 28.0, "diff_num_grad_updates_vs_sampler_policy": 1.0499999523162842, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 7.450580707946131e-10, "vf_explained_var": -0.15088975429534912, "total_loss": -0.3480662405490875, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.449612617492676, "vf_loss": 1.207268906000536e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0025825260672718287, "num_module_steps_trained_lifetime": 39360, "num_module_steps_trained_lifetime_throughput": 2796.010716834511}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 7296.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 28, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-11", "timestamp": 1761044771, "time_this_iter_s": 0.44074463844299316, "time_total_s": 13.81373643875122, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.81373643875122, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.4885382719389152, "restore_env_runners": 1.5431060653581463e-05, "training_step": 0.4882417918815177, "env_runner_sampling_timer": 0.16185949993390233, "learner_update_timer": 0.31834749465947676, "synch_weights": 0.007207628045843069, "synch_env_connectors": 0.002898161643734254}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.42642635963379e-05, "agent_to_module_mapping": 4.809370939084327e-06, "batch_individual_items": 1.938461371709435e-05, "add_time_dim_to_batch_and_zero_pad": 7.449387419774084e-06, "add_observations_from_episodes_to_batch": 2.3799131693035604e-05, "add_states_from_episodes_to_batch": 3.4875484653645215e-06}}, "connector_pipeline_timer": 0.00014320448625319157}, "num_agent_steps_sampled_lifetime": {"player_0": 1888.0, "player_2": 1888.0, "player_3": 1888.0, "player_1": 1888.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.731773472452139e-05, "remove_single_ts_time_rank_from_batch": 1.4752381304136334e-06, "listify_data_for_vector_env": 6.5977562583749375e-06, "get_actions": 0.00021282066121483585, "un_batch_to_individual_items": 1.865316940238807e-05, "normalize_and_clip_actions": 2.654680600613208e-05, "module_to_agent_unmapping": 3.842941154970312e-06}}, "connector_pipeline_timer": 0.0003930987339743574}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407443, "num_module_steps_sampled_lifetime": {"player_0": 7552.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.0696785272383413, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.396609673320571e-05, "env_to_module_sum_episodes_length_out": 35.90625241407443, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.09015684902633157, "weights_seq_no": 28.0, "num_env_steps_sampled_lifetime": 7552.0, "rlmodule_inference_timer": 0.00020297670905647237, "num_env_steps_sampled_lifetime_throughput": 467.30602990482}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0044133182255103815, "add_time_dim_to_batch_and_zero_pad": 1.5598496420512602e-05, "add_columns_from_episodes_to_train_batch": 0.0033077738189158227, "agent_to_module_mapping": 0.00018149063075700557, "add_observations_from_episodes_to_batch": 0.00019870316199894477, "add_states_from_episodes_to_batch": 6.026376030385916e-06, "add_one_ts_to_episodes_and_truncate": 0.0018477600200565215, "numpy_to_tensor": 0.00021890855850789726, "batch_individual_items": 0.0038540436705207866}}, "connector_pipeline_timer": 0.014377073222838871}, "num_module_steps_trained_lifetime": 40768, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 163072, "num_env_steps_trained_lifetime_throughput": 11148.58505529845, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2787.127282564769}, "player_0": {"policy_loss": -0.23642635345458984, "vf_loss_unclipped": 6.73282629577443e-05, "weights_seq_no": 29.0, "diff_num_grad_updates_vs_sampler_policy": 1.0166666507720947, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 3.7252903539730653e-10, "vf_explained_var": -0.5416250228881836, "total_loss": -0.3108578324317932, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.446513652801514, "vf_loss": 6.73282629577443e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0027630666736513376, "num_module_steps_trained_lifetime": 40768, "num_module_steps_trained_lifetime_throughput": 2787.16149018159}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 7552.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 29, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-12", "timestamp": 1761044772, "time_this_iter_s": 0.5172202587127686, "time_total_s": 14.33095669746399, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F34C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.33095669746399, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 23.9, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4880764082199371, "restore_env_runners": 1.5362750119815468e-05, "training_step": 0.48777985896271214, "env_runner_sampling_timer": 0.1615631039348418, "learner_update_timer": 0.3182022237126314, "synch_weights": 0.007190506765326039, "synch_env_connectors": 0.0028906910275287513}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.2321633456734486e-05, "agent_to_module_mapping": 4.6145933672189225e-06, "batch_individual_items": 1.7500586112925143e-05, "add_time_dim_to_batch_and_zero_pad": 6.80309793438461e-06, "add_observations_from_episodes_to_batch": 2.1932786083707492e-05, "add_states_from_episodes_to_batch": 3.665608761361845e-06}}, "connector_pipeline_timer": 0.0001343715265988445}, "num_agent_steps_sampled_lifetime": {"player_0": 1952.0, "player_2": 1952.0, "player_3": 1952.0, "player_1": 1952.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.194653094189259e-05, "remove_single_ts_time_rank_from_batch": 1.3692769562183236e-06, "listify_data_for_vector_env": 6.369565100667104e-06, "get_actions": 0.000194037078365327, "un_batch_to_individual_items": 1.743238224402573e-05, "normalize_and_clip_actions": 2.676339733720441e-05, "module_to_agent_unmapping": 3.817308008769108e-06}}, "connector_pipeline_timer": 0.0003639778119815976}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 7808.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06949517283125771, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.225914117500583e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.09219631662316188, "weights_seq_no": 29.0, "num_env_steps_sampled_lifetime": 7808.0, "rlmodule_inference_timer": 0.00018167673223642273, "num_env_steps_sampled_lifetime_throughput": 469.98003759329686}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004381810043345615, "add_time_dim_to_batch_and_zero_pad": 1.5625511103529935e-05, "add_columns_from_episodes_to_train_batch": 0.0033110120807682167, "agent_to_module_mapping": 0.00018172072430500602, "add_observations_from_episodes_to_batch": 0.00019804413059570016, "add_states_from_episodes_to_batch": 6.011112030657649e-06, "add_one_ts_to_episodes_and_truncate": 0.0018416304201653863, "numpy_to_tensor": 0.0002182304733688622, "batch_individual_items": 0.003850890233768186}}, "connector_pipeline_timer": 0.01433651449071415}, "num_module_steps_trained_lifetime": 42176, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 168704, "num_env_steps_trained_lifetime_throughput": 11206.864956933572, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2801.7735990347264}, "player_0": {"policy_loss": -0.030415788292884827, "vf_loss_unclipped": 4.627211455954239e-05, "weights_seq_no": 30.0, "diff_num_grad_updates_vs_sampler_policy": 1.047619104385376, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.8626451769865326e-10, "vf_explained_var": 0.13830304145812988, "total_loss": -0.10483317822217941, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.444052219390869, "vf_loss": 4.627211455954239e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003261307254433632, "num_module_steps_trained_lifetime": 42176, "num_module_steps_trained_lifetime_throughput": 2801.7295599786426}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 7808.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 30, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-12", "timestamp": 1761044772, "time_this_iter_s": 0.45002198219299316, "time_total_s": 14.780978679656982, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F3E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.780978679656982, "iterations_since_restore": 30, "perf": {}}
{"timers": {"training_iteration": 0.48815165313746256, "restore_env_runners": 1.5303122170226473e-05, "training_step": 0.48785461137325453, "env_runner_sampling_timer": 0.16162924789509048, "learner_update_timer": 0.3182391804757354, "synch_weights": 0.007165278697445677, "synch_env_connectors": 0.0029150761173376482}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.537002609150851e-05, "agent_to_module_mapping": 5.055219421573858e-06, "batch_individual_items": 1.8693531410630763e-05, "add_time_dim_to_batch_and_zero_pad": 7.2621762183124785e-06, "add_observations_from_episodes_to_batch": 2.2996988491003015e-05, "add_states_from_episodes_to_batch": 3.6627175553659868e-06}}, "connector_pipeline_timer": 0.00014472259727272256}, "num_agent_steps_sampled_lifetime": {"player_0": 2016.0, "player_2": 2016.0, "player_3": 2016.0, "player_1": 2016.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.4819312783459674e-05, "remove_single_ts_time_rank_from_batch": 1.5142569887854298e-06, "listify_data_for_vector_env": 6.712986995988997e-06, "get_actions": 0.00020843426920785774, "un_batch_to_individual_items": 1.8891169436118076e-05, "normalize_and_clip_actions": 2.771148428484637e-05, "module_to_agent_unmapping": 3.987618716431784e-06}}, "connector_pipeline_timer": 0.0003885913807226832}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 8064.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06942748008932452, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.511635135938022e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.09390100225777992, "weights_seq_no": 30.0, "num_env_steps_sampled_lifetime": 8064.0, "rlmodule_inference_timer": 0.0001980070424647365, "num_env_steps_sampled_lifetime_throughput": 471.92431528909333}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004351525942939152, "add_time_dim_to_batch_and_zero_pad": 1.565325564733159e-05, "add_columns_from_episodes_to_train_batch": 0.0033134839602338142, "agent_to_module_mapping": 0.00018190451716456533, "add_observations_from_episodes_to_batch": 0.0001974806890200247, "add_states_from_episodes_to_batch": 5.993000648083185e-06, "add_one_ts_to_episodes_and_truncate": 0.0018356341156572527, "numpy_to_tensor": 0.00021758016865904524, "batch_individual_items": 0.003847123331128375}}, "connector_pipeline_timer": 0.014296142345407254}, "num_module_steps_trained_lifetime": 43584, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 174336, "num_env_steps_trained_lifetime_throughput": 11186.842682026658, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2796.70987473252}, "player_0": {"policy_loss": -0.26988330483436584, "vf_loss_unclipped": 0.0001570168387843296, "weights_seq_no": 31.0, "diff_num_grad_updates_vs_sampler_policy": 1.0163934230804443, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 9.313225884932663e-11, "vf_explained_var": -0.8876668214797974, "total_loss": -0.34420469403266907, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.439991474151611, "vf_loss": 0.0001570168387843296, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003019146854057908, "num_module_steps_trained_lifetime": 43584, "num_module_steps_trained_lifetime_throughput": 2796.720888909704}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8064.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 31, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-13", "timestamp": 1761044773, "time_this_iter_s": 0.500342845916748, "time_total_s": 15.28132152557373, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.28132152557373, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.9, "ram_util_percent": 54.7}}
{"timers": {"training_iteration": 0.4874812686057063, "restore_env_runners": 1.526009120404187e-05, "training_step": 0.48718167125955425, "env_runner_sampling_timer": 0.1613072544158496, "learner_update_timer": 0.31791839367119457, "synch_weights": 0.007138501910500255, "synch_env_connectors": 0.002907876356254029}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.1146616270279236e-05, "agent_to_module_mapping": 4.521281148997283e-06, "batch_individual_items": 1.6680120497682185e-05, "add_time_dim_to_batch_and_zero_pad": 6.5631440715443e-06, "add_observations_from_episodes_to_batch": 2.173113353175458e-05, "add_states_from_episodes_to_batch": 3.198245982897519e-06}}, "connector_pipeline_timer": 0.00013099224595735563}, "num_agent_steps_sampled_lifetime": {"player_0": 2080.0, "player_2": 2080.0, "player_3": 2080.0, "player_1": 2080.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.9671734819113305e-05, "remove_single_ts_time_rank_from_batch": 1.3243315182494903e-06, "listify_data_for_vector_env": 6.2703129238406416e-06, "get_actions": 0.0001919242242902218, "un_batch_to_individual_items": 1.7141378950795505e-05, "normalize_and_clip_actions": 2.467026978666596e-05, "module_to_agent_unmapping": 3.6049505334531434e-06}}, "connector_pipeline_timer": 0.0003573025193062601}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 8320.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.0692025112729705, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.1788451469726594e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.0957458677280533, "weights_seq_no": 31.0, "num_env_steps_sampled_lifetime": 8320.0, "rlmodule_inference_timer": 0.0001704057448841265, "num_env_steps_sampled_lifetime_throughput": 475.32845685864197}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.00432007568341052, "add_time_dim_to_batch_and_zero_pad": 1.5629722939432672e-05, "add_columns_from_episodes_to_train_batch": 0.0033115591207925573, "agent_to_module_mapping": 0.00018175247188059472, "add_observations_from_episodes_to_batch": 0.00019679688206483304, "add_states_from_episodes_to_batch": 5.964070877651648e-06, "add_one_ts_to_episodes_and_truncate": 0.0018289137746272804, "numpy_to_tensor": 0.00021703736718331368, "batch_individual_items": 0.00383775209762766}}, "connector_pipeline_timer": 0.014243498921664441}, "num_module_steps_trained_lifetime": 44992, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 179968, "num_env_steps_trained_lifetime_throughput": 11269.922771717742, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2817.501044007772}, "player_0": {"policy_loss": -0.17288757860660553, "vf_loss_unclipped": 2.072790084639564e-05, "weights_seq_no": 32.0, "diff_num_grad_updates_vs_sampler_policy": 1.017543911933899, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 4.6566129424663316e-11, "vf_explained_var": 0.10113745927810669, "total_loss": -0.24714946746826172, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.4272236824035645, "vf_loss": 2.072790084639564e-05, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003685192670673132, "num_module_steps_trained_lifetime": 44992, "num_module_steps_trained_lifetime_throughput": 2817.491536229386}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8320.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 32, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-13", "timestamp": 1761044773, "time_this_iter_s": 0.42792463302612305, "time_total_s": 15.709246158599854, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F34C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.709246158599854, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.4876073429194184, "restore_env_runners": 1.5206490463759685e-05, "training_step": 0.4873075865471513, "env_runner_sampling_timer": 0.1612041408720867, "learner_update_timer": 0.3181665397344594, "synch_weights": 0.007122823891824064, "synch_env_connectors": 0.0029071325930798133}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.29076459025766e-05, "agent_to_module_mapping": 4.576456188086953e-06, "batch_individual_items": 1.722948209050883e-05, "add_time_dim_to_batch_and_zero_pad": 6.967645238199245e-06, "add_observations_from_episodes_to_batch": 2.2177135745111476e-05, "add_states_from_episodes_to_batch": 3.1964303998227844e-06}}, "connector_pipeline_timer": 0.00013572122647519734}, "num_agent_steps_sampled_lifetime": {"player_0": 2144.0, "player_2": 2144.0, "player_3": 2144.0, "player_1": 2144.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.184576047307068e-05, "remove_single_ts_time_rank_from_batch": 1.34257095039798e-06, "listify_data_for_vector_env": 6.364459097782999e-06, "get_actions": 0.0001966898994017478, "un_batch_to_individual_items": 1.7553119854790866e-05, "normalize_and_clip_actions": 2.52418881043488e-05, "module_to_agent_unmapping": 3.648091145352472e-06}}, "connector_pipeline_timer": 0.0003671841029362603}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 8576.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06903207334859487, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.205182819621031e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.09717407187504666, "weights_seq_no": 32.0, "num_env_steps_sampled_lifetime": 8576.0, "rlmodule_inference_timer": 0.00017893285668224267, "num_env_steps_sampled_lifetime_throughput": 479.05788976702297}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0042902619266482304, "add_time_dim_to_batch_and_zero_pad": 1.5627425718517108e-05, "add_columns_from_episodes_to_train_batch": 0.003316184529417381, "agent_to_module_mapping": 0.00018189494695220392, "add_observations_from_episodes_to_batch": 0.00019613791331625418, "add_states_from_episodes_to_batch": 5.947429914221737e-06, "add_one_ts_to_episodes_and_truncate": 0.0018240226364545065, "numpy_to_tensor": 0.0002163979935277377, "batch_individual_items": 0.0038333955766799714}}, "connector_pipeline_timer": 0.01420620493210583}, "num_module_steps_trained_lifetime": 46400, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 185600, "num_env_steps_trained_lifetime_throughput": 11245.781227129346, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2811.4988425432757}, "player_0": {"policy_loss": -0.12482864409685135, "vf_loss_unclipped": 6.985741038079141e-06, "weights_seq_no": 33.0, "diff_num_grad_updates_vs_sampler_policy": 1.0166666507720947, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 2.3283064712331658e-11, "vf_explained_var": -1.0, "total_loss": -0.19899384677410126, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.4168701171875, "vf_loss": 6.985741038079141e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.002635426353663206, "num_module_steps_trained_lifetime": 46400, "num_module_steps_trained_lifetime_throughput": 2811.4574415978636}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8576.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 33, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-14", "timestamp": 1761044774, "time_this_iter_s": 0.5223438739776611, "time_total_s": 16.231590032577515, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F3E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.231590032577515, "iterations_since_restore": 33, "perf": {}}
{"timers": {"training_iteration": 0.4870719634903538, "restore_env_runners": 1.5149425700422348e-05, "training_step": 0.4867722566814807, "env_runner_sampling_timer": 0.16092771046332444, "learner_update_timer": 0.31794483533712986, "synch_weights": 0.007089276653445856, "synch_env_connectors": 0.0030845862669612602}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.12884671493009e-05, "agent_to_module_mapping": 4.400873677162686e-06, "batch_individual_items": 1.6632636406158243e-05, "add_time_dim_to_batch_and_zero_pad": 6.674346705913592e-06, "add_observations_from_episodes_to_batch": 2.1647903019912943e-05, "add_states_from_episodes_to_batch": 3.0686539984466944e-06}}, "connector_pipeline_timer": 0.00012942939576838461}, "num_agent_steps_sampled_lifetime": {"player_0": 2208.0, "player_2": 2208.0, "player_3": 2208.0, "player_1": 2208.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.102200891516971e-05, "remove_single_ts_time_rank_from_batch": 1.2936852501903017e-06, "listify_data_for_vector_env": 6.293412203263217e-06, "get_actions": 0.00018818994964018272, "un_batch_to_individual_items": 1.6947707823991292e-05, "normalize_and_clip_actions": 2.493514879704708e-05, "module_to_agent_unmapping": 3.525020118764739e-06}}, "connector_pipeline_timer": 0.00035390485574463834}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 8832.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06882853653427781, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.052448191072843e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.0992780486498177, "weights_seq_no": 33.0, "num_env_steps_sampled_lifetime": 8832.0, "rlmodule_inference_timer": 0.00017136540844981998, "num_env_steps_sampled_lifetime_throughput": 479.8322946989522}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004259539306994019, "add_time_dim_to_batch_and_zero_pad": 1.558515174730757e-05, "add_columns_from_episodes_to_train_batch": 0.0033141916839720944, "agent_to_module_mapping": 0.0001817479974084294, "add_observations_from_episodes_to_batch": 0.00019556653370778184, "add_states_from_episodes_to_batch": 5.921955873972294e-06, "add_one_ts_to_episodes_and_truncate": 0.0018197074096017623, "numpy_to_tensor": 0.00021578501317893076, "batch_individual_items": 0.0038241176209707797}}, "connector_pipeline_timer": 0.014156636882767025}, "num_module_steps_trained_lifetime": 47808, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 191232, "num_env_steps_trained_lifetime_throughput": 11281.626437159483, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2820.462359717527}, "player_0": {"policy_loss": -0.04490109160542488, "vf_loss_unclipped": 3.319455572636798e-06, "weights_seq_no": 34.0, "diff_num_grad_updates_vs_sampler_policy": 1.0508474111557007, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.1641532356165829e-11, "vf_explained_var": 0.5083640813827515, "total_loss": -0.11906818300485611, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.416874885559082, "vf_loss": 3.319455572636798e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0029626318719238043, "num_module_steps_trained_lifetime": 47808, "num_module_steps_trained_lifetime_throughput": 2820.4310019947075}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 8832.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 34, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-14", "timestamp": 1761044774, "time_this_iter_s": 0.43875908851623535, "time_total_s": 16.67034912109375, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.67034912109375, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.4870327328552212, "restore_env_runners": 1.5091931577103893e-05, "training_step": 0.48673276811468097, "env_runner_sampling_timer": 0.160714068358772, "learner_update_timer": 0.31814656898391597, "synch_weights": 0.0070648918865615995, "synch_env_connectors": 0.0030799744043979896}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.139151153436405e-05, "agent_to_module_mapping": 5.044624813323956e-06, "batch_individual_items": 1.6565922452889652e-05, "add_time_dim_to_batch_and_zero_pad": 6.6333392242780755e-06, "add_observations_from_episodes_to_batch": 2.1272393899864704e-05, "add_states_from_episodes_to_batch": 3.219481995703372e-06}}, "connector_pipeline_timer": 0.0001295771097931022}, "num_agent_steps_sampled_lifetime": {"player_0": 2272.0, "player_2": 2272.0, "player_3": 2272.0, "player_1": 2272.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.100685781881148e-05, "remove_single_ts_time_rank_from_batch": 1.364573767129277e-06, "listify_data_for_vector_env": 6.246052282115513e-06, "get_actions": 0.0001874058372796602, "un_batch_to_individual_items": 1.6953424721992742e-05, "normalize_and_clip_actions": 2.5548680714602633e-05, "module_to_agent_unmapping": 3.5362220286292404e-06}}, "connector_pipeline_timer": 0.000354343070880857}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 9088.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06862029048985772, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.035499373078986e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.10066195882436511, "weights_seq_no": 34.0, "num_env_steps_sampled_lifetime": 9088.0, "rlmodule_inference_timer": 0.00016781756299267983, "num_env_steps_sampled_lifetime_throughput": 483.921853863338}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004229673914231862, "add_time_dim_to_batch_and_zero_pad": 1.557530017739731e-05, "add_columns_from_episodes_to_train_batch": 0.0033155347672016266, "agent_to_module_mapping": 0.0001816925174633204, "add_observations_from_episodes_to_batch": 0.0001950088679563102, "add_states_from_episodes_to_batch": 5.904736635041292e-06, "add_one_ts_to_episodes_and_truncate": 0.0018151173355065195, "numpy_to_tensor": 0.00021529616295004549, "batch_individual_items": 0.0038162594444457335}}, "connector_pipeline_timer": 0.01411277751403475}, "num_module_steps_trained_lifetime": 49216, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 196864, "num_env_steps_trained_lifetime_throughput": 11282.940091673972, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2820.7619378706936}, "player_0": {"policy_loss": -0.06841239333152771, "vf_loss_unclipped": 8.262121014013246e-07, "weights_seq_no": 35.0, "diff_num_grad_updates_vs_sampler_policy": 1.0322580337524414, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 5.8207661780829145e-12, "vf_explained_var": 0.6636331081390381, "total_loss": -0.14248955249786377, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.407757759094238, "vf_loss": 8.262121014013246e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003199697704985738, "num_module_steps_trained_lifetime": 49216, "num_module_steps_trained_lifetime_throughput": 2820.7454261773073}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9088.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 35, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-15", "timestamp": 1761044775, "time_this_iter_s": 0.48658323287963867, "time_total_s": 17.15693235397339, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.15693235397339, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.5, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.488848985526765, "restore_env_runners": 1.5035012395018621e-05, "training_step": 0.48854851943374733, "env_runner_sampling_timer": 0.16273864367498406, "learner_update_timer": 0.317956139293807, "synch_weights": 0.007047356967588941, "synch_env_connectors": 0.0030694596605637062}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.227424083452072e-05, "agent_to_module_mapping": 4.738886731138226e-06, "batch_individual_items": 2.002758596156096e-05, "add_time_dim_to_batch_and_zero_pad": 6.954544548999402e-06, "add_observations_from_episodes_to_batch": 2.2234402364743643e-05, "add_states_from_episodes_to_batch": 3.3080571541956637e-06}}, "connector_pipeline_timer": 0.00013901449728828078}, "num_agent_steps_sampled_lifetime": {"player_0": 2336.0, "player_2": 2336.0, "player_3": 2336.0, "player_1": 2336.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.249724216576179e-05, "remove_single_ts_time_rank_from_batch": 1.5385688993472512e-06, "listify_data_for_vector_env": 6.299449749565166e-06, "get_actions": 0.00020201184801403238, "un_batch_to_individual_items": 1.7391333346323967e-05, "normalize_and_clip_actions": 2.5689239799908315e-05, "module_to_agent_unmapping": 3.6056366426504624e-06}}, "connector_pipeline_timer": 0.0003727814943040903}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 9344.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06924829069672307, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.094012520457625e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.10313245623119129, "weights_seq_no": 35.0, "num_env_steps_sampled_lifetime": 9344.0, "rlmodule_inference_timer": 0.00018304226361797946, "num_env_steps_sampled_lifetime_throughput": 477.4539492662705}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004200528175110569, "add_time_dim_to_batch_and_zero_pad": 1.5549547001354256e-05, "add_columns_from_episodes_to_train_batch": 0.0033149484195614093, "agent_to_module_mapping": 0.00018208559281857249, "add_observations_from_episodes_to_batch": 0.00019418477911951746, "add_states_from_episodes_to_batch": 5.897689664644534e-06, "add_one_ts_to_episodes_and_truncate": 0.001808352162120661, "numpy_to_tensor": 0.00021464720113121088, "batch_individual_items": 0.0038152588500818467}}, "connector_pipeline_timer": 0.014072365738618746}, "num_module_steps_trained_lifetime": 50624, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 202496, "num_env_steps_trained_lifetime_throughput": 11131.131976957462, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2782.808382301268}, "player_0": {"policy_loss": -0.014371192082762718, "vf_loss_unclipped": 1.3673317198481527e-06, "weights_seq_no": 36.0, "diff_num_grad_updates_vs_sampler_policy": 1.1166666746139526, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 2.9103830890414573e-12, "vf_explained_var": 0.11126124858856201, "total_loss": -0.0883372575044632, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.396673679351807, "vf_loss": 1.3673317198481527e-06, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.004436403047293425, "num_module_steps_trained_lifetime": 50624, "num_module_steps_trained_lifetime_throughput": 2782.792877326453}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9344.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 36, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-16", "timestamp": 1761044776, "time_this_iter_s": 0.6736011505126953, "time_total_s": 17.830533504486084, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x00000261000F2840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.830533504486084, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.5, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.4893102906714265, "restore_env_runners": 1.4970662343838256e-05, "training_step": 0.4890095842390772, "env_runner_sampling_timer": 0.16323162023808324, "learner_update_timer": 0.31795914790093166, "synch_weights": 0.007014698397727196, "synch_env_connectors": 0.003069500063994726}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.1608299078588825e-05, "agent_to_module_mapping": 5.5361492844177845e-06, "batch_individual_items": 2.213102232080189e-05, "add_time_dim_to_batch_and_zero_pad": 8.569427300960417e-06, "add_observations_from_episodes_to_batch": 2.6161991534140288e-05, "add_states_from_episodes_to_batch": 3.839407049295804e-06}}, "connector_pipeline_timer": 0.00016485124025431588}, "num_agent_steps_sampled_lifetime": {"player_0": 2400.0, "player_2": 2400.0, "player_3": 2400.0, "player_1": 2400.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.284374168898156e-05, "remove_single_ts_time_rank_from_batch": 1.74590637348756e-06, "listify_data_for_vector_env": 7.0952684609746435e-06, "get_actions": 0.00024781001829186276, "un_batch_to_individual_items": 2.0515030024724707e-05, "normalize_and_clip_actions": 3.0290881503198265e-05, "module_to_agent_unmapping": 4.739035073526543e-06}}, "connector_pipeline_timer": 0.0004482618855082878}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 9600.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06945212075675017, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.982682242159805e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.10534967986471953, "weights_seq_no": 36.0, "num_env_steps_sampled_lifetime": 9600.0, "rlmodule_inference_timer": 0.00025726397036613145, "num_env_steps_sampled_lifetime_throughput": 477.0787087547629}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004171451893436301, "add_time_dim_to_batch_and_zero_pad": 1.55290513951441e-05, "add_columns_from_episodes_to_train_batch": 0.003312985935351743, "agent_to_module_mapping": 0.00018201173680514466, "add_observations_from_episodes_to_batch": 0.00019357393156791062, "add_states_from_episodes_to_batch": 5.874712460043241e-06, "add_one_ts_to_episodes_and_truncate": 0.0018030766402370151, "numpy_to_tensor": 0.0002140537287215982, "batch_individual_items": 0.0038061272619542056}}, "connector_pipeline_timer": 0.014023852081380602}, "num_module_steps_trained_lifetime": 52032, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 208128, "num_env_steps_trained_lifetime_throughput": 11073.917951733618, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2768.488201657315}, "player_0": {"policy_loss": -0.10466380417346954, "vf_loss_unclipped": 3.7921225271020376e-07, "weights_seq_no": 37.0, "diff_num_grad_updates_vs_sampler_policy": 1.017543911933899, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 1.4551915445207286e-12, "vf_explained_var": 0.8725236654281616, "total_loss": -0.17856356501579285, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.389995574951172, "vf_loss": 3.7921225271020376e-07, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003059576265513897, "num_module_steps_trained_lifetime": 52032, "num_module_steps_trained_lifetime_throughput": 2768.488168516836}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9600.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 37, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-16", "timestamp": 1761044776, "time_this_iter_s": 0.5412077903747559, "time_total_s": 18.37174129486084, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100165C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.37174129486084, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 28.5, "ram_util_percent": 54.8}}
{"timers": {"training_iteration": 0.4888701927649627, "restore_env_runners": 1.4915955861700134e-05, "training_step": 0.48856861639651933, "env_runner_sampling_timer": 0.1629503000358126, "learner_update_timer": 0.31779867442186066, "synch_weights": 0.007010177413454859, "synch_env_connectors": 0.0030649630628824193}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.600217960659234e-05, "agent_to_module_mapping": 4.897527797499345e-06, "batch_individual_items": 1.9138428259499632e-05, "add_time_dim_to_batch_and_zero_pad": 7.393536913696922e-06, "add_observations_from_episodes_to_batch": 2.3509958272691865e-05, "add_states_from_episodes_to_batch": 3.4693401419330523e-06}}, "connector_pipeline_timer": 0.00014500086563746625}, "num_agent_steps_sampled_lifetime": {"player_0": 2464.0, "player_2": 2464.0, "player_3": 2464.0, "player_1": 2464.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.654082231195114e-05, "remove_single_ts_time_rank_from_batch": 1.4735780953391342e-06, "listify_data_for_vector_env": 6.600726972683329e-06, "get_actions": 0.0002153206470667941, "un_batch_to_individual_items": 1.874195655050844e-05, "normalize_and_clip_actions": 2.707665699583156e-05, "module_to_agent_unmapping": 3.989401737580678e-06}}, "connector_pipeline_timer": 0.00039639616873687807}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 9856.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.06938940428336834, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.488544260005105e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.10694077845057953, "weights_seq_no": 37.0, "num_env_steps_sampled_lifetime": 9856.0, "rlmodule_inference_timer": 0.00021268528317643028, "num_env_steps_sampled_lifetime_throughput": 480.1311138160318}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0041442763746145014, "add_time_dim_to_batch_and_zero_pad": 1.5556760528415118e-05, "add_columns_from_episodes_to_train_batch": 0.0033188510754842476, "agent_to_module_mapping": 0.00018236261967001326, "add_observations_from_episodes_to_batch": 0.00019313119197913794, "add_states_from_episodes_to_batch": 5.861965103632895e-06, "add_one_ts_to_episodes_and_truncate": 0.0018014698737486132, "numpy_to_tensor": 0.00021373919136860847, "batch_individual_items": 0.0038048279892798197}}, "connector_pipeline_timer": 0.013997886560493266}, "num_module_steps_trained_lifetime": 53440, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 213760, "num_env_steps_trained_lifetime_throughput": 11133.134526731614, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2783.3182946324646}, "player_0": {"policy_loss": 0.07480092346668243, "vf_loss_unclipped": 3.747608801063507e-08, "weights_seq_no": 38.0, "diff_num_grad_updates_vs_sampler_policy": 1.0327868461608887, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 7.275957722603643e-13, "vf_explained_var": 0.9910666942596436, "total_loss": 0.0009363596327602863, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.386457920074463, "vf_loss": 3.747608801063507e-08, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.003012260887771845, "num_module_steps_trained_lifetime": 53440, "num_module_steps_trained_lifetime_throughput": 2783.292812068109}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 9856.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 38, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-17", "timestamp": 1761044777, "time_this_iter_s": 0.4503059387207031, "time_total_s": 18.822047233581543, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100164C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.822047233581543, "iterations_since_restore": 38, "perf": {}}
{"timers": {"training_iteration": 0.4890326108377388, "restore_env_runners": 1.486979650529934e-05, "training_step": 0.4887305852327891, "env_runner_sampling_timer": 0.16331145203542677, "learner_update_timer": 0.3176237776777714, "synch_weights": 0.006988868639489409, "synch_env_connectors": 0.003066556432131376}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.9108842958288586e-05, "agent_to_module_mapping": 5.1953358920059455e-06, "batch_individual_items": 2.0454969613684012e-05, "add_time_dim_to_batch_and_zero_pad": 7.9555488373756e-06, "add_observations_from_episodes_to_batch": 2.5266256338353442e-05, "add_states_from_episodes_to_batch": 3.724670802842043e-06}}, "connector_pipeline_timer": 0.0001564370536008765}, "num_agent_steps_sampled_lifetime": {"player_0": 2528.0, "player_2": 2528.0, "player_3": 2528.0, "player_1": 2528.0}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 6.051542243351351e-05, "remove_single_ts_time_rank_from_batch": 1.569652110945917e-06, "listify_data_for_vector_env": 6.994862253325237e-06, "get_actions": 0.00023062751995164778, "un_batch_to_individual_items": 2.001525750044887e-05, "normalize_and_clip_actions": 2.8613858956415966e-05, "module_to_agent_unmapping": 4.237941307915074e-06}}, "connector_pipeline_timer": 0.00042393852404192265}, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.0199979189783335e-05, "add_observations_from_episodes_to_batch": 4.125002305954695e-05, "add_states_from_episodes_to_batch": 8.300034096464515e-06, "numpy_to_tensor": 8.99999868124723e-05, "agent_to_module_mapping": 1.1149997590109706e-05, "batch_individual_items": 4.2150000808760503e-05}}, "env_to_module_sum_episodes_length_in": 35.90625241407444, "num_module_steps_sampled_lifetime": {"player_0": 10112.0}, "num_module_steps_sampled": {"player_0": 256.0}, "num_agent_steps_sampled": {"player_2": 64.0, "player_3": 64.0, "player_1": 64.0, "player_0": 64.0}, "env_reset_timer": 0.00015375000657513738, "sample": 0.069448462980771, "connector_pipeline_timer": 0.0005247000080998987, "env_step_timer": 4.832779993995753e-05, "env_to_module_sum_episodes_length_out": 35.90625241407444, "num_env_steps_sampled": 256.0, "time_between_sampling": 0.10840982015930392, "weights_seq_no": 38.0, "num_env_steps_sampled_lifetime": 10112.0, "rlmodule_inference_timer": 0.0002364548632526219, "num_env_steps_sampled_lifetime_throughput": 480.0010346674828}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.004123662610563724, "add_time_dim_to_batch_and_zero_pad": 1.554219283262131e-05, "add_columns_from_episodes_to_train_batch": 0.0033204705649298332, "agent_to_module_mapping": 0.00018236199338469592, "add_observations_from_episodes_to_batch": 0.00019253188030654935, "add_states_from_episodes_to_batch": 5.8393457267183265e-06, "add_one_ts_to_episodes_and_truncate": 0.0017964651751226624, "numpy_to_tensor": 0.00021339479971994697, "batch_individual_items": 0.00379949170934354}}, "connector_pipeline_timer": 0.013965858694988335}, "num_module_steps_trained_lifetime": 54848, "num_env_steps_trained": 5632, "learner_connector_sum_episodes_length_out": 256.0, "num_module_steps_trained": 1408, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 256.0, "num_trainable_parameters": 657617, "num_env_steps_trained_lifetime": 219392, "num_env_steps_trained_lifetime_throughput": 11103.36297721263, "num_module_steps_trained_throughput": 0.0, "num_module_steps_trained_lifetime_throughput": 2775.8429482118927}, "player_0": {"policy_loss": -0.07116980850696564, "vf_loss_unclipped": 1.5477789050422075e-09, "weights_seq_no": 39.0, "diff_num_grad_updates_vs_sampler_policy": 1.100000023841858, "module_train_batch_size_mean": 64.0, "curr_kl_coeff": 3.6379788613018216e-13, "vf_explained_var": 0.9987752437591553, "total_loss": -0.14499761164188385, "default_optimizer_learning_rate": 5e-05, "num_module_steps_trained": 1408, "entropy": 7.382779598236084, "vf_loss": 1.5477789050422075e-09, "curr_entropy_coeff": 0.01, "num_trainable_parameters": 657617, "mean_kl_loss": 0.0021851244382560253, "num_module_steps_trained_lifetime": 54848, "num_module_steps_trained_lifetime_throughput": 2775.8486277178004}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 10112.0, "fault_tolerance": {"num_healthy_workers": 2, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 39, "trial_id": "e5023_00000", "date": "2025-10-21_13-06-17", "timestamp": 1761044777, "time_this_iter_s": 0.508897066116333, "time_total_s": 19.330944299697876, "pid": 35072, "hostname": "Aspire5", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "koehandel_env", "env_config": {"num_players": 4}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 2, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 64, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": null, "train_batch_size": 256, "num_epochs": 5, "minibatch_size": 64, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x0000026100165A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_evaluation_type": null, "offline_eval_runner_class": null, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": false, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": null, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "vf_loss_coeff": 0.5, "entropy_coeff": 0.01, "clip_param": 0.2, "vf_clip_param": 10.0, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"player_0": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.330944299697876, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 54.9}}
